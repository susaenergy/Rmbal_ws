<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Material Balance - Gas Condensate Reservoirs â€¢ Rmbal</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Material Balance - Gas Condensate Reservoirs">
<meta property="og:description" content="Rmbal">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rmbal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BlackOil.html">Material Balance - Black Oil Reservoirs</a>
    </li>
    <li>
      <a href="../articles/DryWetGas.html">Material Balance - Dry and Wet Gas Reservoirs</a>
    </li>
    <li>
      <a href="../articles/GasCondensate.html">Material Balance - Gas Condensate Reservoirs</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Rmbal Package</a>
    </li>
    <li>
      <a href="../articles/VolatileOil.html">Material Balance - Volatile Oil Reservoirs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Material Balance - Gas Condensate Reservoirs</h1>
            
      
      
      <div class="hidden name"><code>GasCondensate.Rmd</code></div>

    </div>

    
    
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a><code>Examples</code>
</h2>
<div id="example-1-lean-gas-condensate-reservoir-walsh2003" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-lean-gas-condensate-reservoir-walsh2003" class="anchor"></a><code>Example 1: Lean Gas Condensate Reservoir</code> <font size="2"> <span class="citation">(Walsh &amp; Lake, 2003)</span> </font>
</h3>
<div id="part-i-history-match" class="section level4">
<h4 class="hasAnchor">
<a href="#part-i-history-match" class="anchor"></a><code>Part I: History Match</code>
</h4>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rmbal</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rrelperm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pracma</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">minpack.lm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'magrittr'</span>
<span class="co">#&gt; The following objects are masked from 'package:pracma':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     and, mod, or</span>

<span class="no">p_pvt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3700</span>, <span class="fl">3650</span>, <span class="fl">3400</span>, <span class="fl">3100</span>, <span class="fl">2800</span>, <span class="fl">2500</span>, <span class="fl">2200</span>, <span class="fl">1900</span>, <span class="fl">1600</span>, <span class="fl">1300</span>, <span class="fl">1000</span>, <span class="fl">700</span>,
           <span class="fl">600</span>, <span class="fl">400</span>)

<span class="no">Bo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10.057</span>, <span class="fl">2.417</span>, <span class="fl">2.192</span>, <span class="fl">1.916</span>, <span class="fl">1.736</span>, <span class="fl">1.617</span>, <span class="fl">1.504</span>, <span class="fl">1.416</span>, <span class="fl">1.326</span>, <span class="fl">1.268</span>, <span class="fl">1.205</span>,
        <span class="fl">1.149</span>, <span class="fl">1.131</span>, <span class="fl">1.093</span>)

<span class="no">Rv</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">84.11765</span>, <span class="fl">84.11765</span>, <span class="fl">70.5</span>, <span class="fl">56.2</span>, <span class="fl">46.5</span>, <span class="fl">39.5</span>, <span class="fl">33.8</span>, <span class="fl">29.9</span>, <span class="fl">27.3</span>, <span class="fl">25.5</span>, <span class="fl">25.9</span>,
        <span class="fl">28.3</span>, <span class="fl">29.8</span>, <span class="fl">33.5</span>) / <span class="fl">1e6</span>

<span class="no">Rs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">11566</span>, <span class="fl">2378</span>, <span class="fl">2010</span>, <span class="fl">1569</span>, <span class="fl">1272</span>, <span class="fl">1067</span>, <span class="fl">873</span>, <span class="fl">719</span>, <span class="fl">565</span>, <span class="fl">461</span>, <span class="fl">349</span>, <span class="fl">249</span>, <span class="fl">218</span>, <span class="fl">141</span>)

<span class="no">Bg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.87</span>, <span class="fl">0.88</span>, <span class="fl">0.92</span>, <span class="fl">0.99</span>, <span class="fl">1.08</span>, <span class="fl">1.20</span>, <span class="fl">1.35</span>, <span class="fl">1.56</span>, <span class="fl">1.85</span>, <span class="fl">2.28</span>, <span class="fl">2.95</span>, <span class="fl">4.09</span>,
        <span class="fl">4.68</span>, <span class="fl">6.53</span>) / <span class="fl">1000</span>

<span class="no">cw</span> <span class="kw">&lt;-</span> <span class="fl">3e-6</span>

<span class="no">Bwi</span> <span class="kw">&lt;-</span> <span class="fl">10.05</span>

<span class="no">Bw</span> <span class="kw">&lt;-</span> <span class="no">Bwi</span> * <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">cw</span> * (<span class="no">p_pvt</span>[<span class="fl">1</span>] - <span class="no">p_pvt</span>))

<span class="no">muo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.0612</span>, <span class="fl">0.062</span>, <span class="fl">0.1338</span>, <span class="fl">0.1826</span>, <span class="fl">0.2354</span>, <span class="fl">0.3001</span>, <span class="fl">0.3764</span>, <span class="fl">0.4781</span>, <span class="fl">0.6041</span>,
         <span class="fl">0.7746</span>, <span class="fl">1.0295</span>, <span class="fl">1.358</span>, <span class="fl">1.855</span>, <span class="fl">2.500</span>)

<span class="no">mug</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.0612</span>, <span class="fl">0.062</span>, <span class="fl">0.0554</span>, <span class="fl">0.0436</span>, <span class="fl">0.0368</span>, <span class="fl">0.0308</span>, <span class="fl">0.0261</span>, <span class="fl">0.0222</span>, <span class="fl">0.0191</span>,
         <span class="fl">0.0166</span>, <span class="fl">0.0148</span>, <span class="fl">0.0135</span>, <span class="fl">0.0125</span>, <span class="fl">0.0115</span>)

<span class="no">muw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.25</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p_pvt</span>))

<span class="no">pvt_table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="no">p_pvt</span>, <span class="kw">Bo</span> <span class="kw">=</span> <span class="no">Bo</span>, <span class="kw">Rs</span> <span class="kw">=</span> <span class="no">Rs</span>, <span class="kw">Rv</span> <span class="kw">=</span> <span class="no">Rv</span>, <span class="kw">Bg</span> <span class="kw">=</span> <span class="no">Bg</span>,
                               <span class="kw">Bw</span> <span class="kw">=</span> <span class="no">Bw</span>, <span class="kw">muo</span> <span class="kw">=</span> <span class="no">muo</span>, <span class="kw">mug</span> <span class="kw">=</span> <span class="no">mug</span>, <span class="kw">muw</span> <span class="kw">=</span> <span class="no">muw</span>)

<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3700</span>, <span class="fl">3650</span>, <span class="fl">3400</span>, <span class="fl">3100</span>, <span class="fl">2800</span>, <span class="fl">2500</span>, <span class="fl">2200</span>, <span class="fl">1900</span>, <span class="fl">1600</span>, <span class="fl">1300</span>, <span class="fl">1000</span>, <span class="fl">700</span>,
           <span class="fl">600</span>)

<span class="no">We</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">Np</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">28.6</span>, <span class="fl">93</span>, <span class="fl">231</span>, <span class="fl">270</span>, <span class="fl">379</span>, <span class="fl">481</span>, <span class="fl">517.2</span>, <span class="fl">549</span>, <span class="fl">580</span>, <span class="fl">675</span>, <span class="fl">755</span>, <span class="fl">803</span>) *<span class="fl">1e3</span>

<span class="no">Gp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.34</span>, <span class="fl">1.2</span>, <span class="fl">3.3</span>, <span class="fl">4.3</span>, <span class="fl">6.6</span>, <span class="fl">9.1</span>, <span class="fl">10.5</span>, <span class="fl">12</span>, <span class="fl">12.8</span>, <span class="fl">16.4</span>, <span class="fl">19.1</span>, <span class="fl">20.5</span>) * <span class="fl">1e9</span>

<span class="no">Wp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">Wi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">wf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">mbal_optim_gas_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_optim_param_gas.html">mbal_optim_param_gas</a></span>(<span class="kw">input_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>, <span class="kw">output_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>,
                                          <span class="kw">unknown_param</span> <span class="kw">=</span> <span class="st">"G"</span>, <span class="kw">aquifer_model</span> <span class="kw">=</span> <span class="kw">NULL</span>,
                                          <span class="kw">phi</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">swi</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">Np</span> <span class="kw">=</span> <span class="no">Np</span>,
                                          <span class="kw">Gp</span> <span class="kw">=</span> <span class="no">Gp</span>, <span class="kw">Wp</span> <span class="kw">=</span> <span class="no">Wp</span>, <span class="kw">Wi</span> <span class="kw">=</span> <span class="no">Wi</span>, <span class="kw">We</span> <span class="kw">=</span> <span class="no">We</span>,
                                          <span class="kw">pd</span> <span class="kw">=</span> <span class="fl">3650</span>, <span class="kw">p</span> <span class="kw">=</span> <span class="no">p</span>, <span class="kw">pvt</span> <span class="kw">=</span> <span class="no">pvt_table</span>, <span class="kw">M</span> <span class="kw">=</span> <span class="fl">0</span>,
                                          <span class="kw">cf</span> <span class="kw">=</span> <span class="fl">2e-6</span>, <span class="kw">wf</span> <span class="kw">=</span> <span class="no">wf</span>, <span class="kw">sgrw</span> <span class="kw">=</span> <span class="fl">0.15</span>)

<span class="no">time_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_time.html">mbal_time</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>)), <span class="st">"year"</span>)

<span class="co"># a number of plots will be automatically generated for quality check</span>

<span class="no">optim_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_optim_gas.html">mbal_optim_gas</a></span>(<span class="no">mbal_optim_gas_lst</span>, <span class="no">time_lst</span>)</pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"><img src="GasCondensate_files/figure-html/unnamed-chunk-2-2.png" width="576" style="display: block; margin: auto;"><img src="GasCondensate_files/figure-html/unnamed-chunk-2-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="no">optim_results</span>)
<span class="co">#&gt; List of 17</span>
<span class="co">#&gt;  $ input_unit : chr "Field"</span>
<span class="co">#&gt;  $ output_unit: chr "Field"</span>
<span class="co">#&gt;  $ G          : num 2.41e+10</span>
<span class="co">#&gt;  $ phi        : num 0.1</span>
<span class="co">#&gt;  $ swi        : num 0.2</span>
<span class="co">#&gt;  $ pd         : num 3650</span>
<span class="co">#&gt;  $ p          : num [1:13] 3700 3650 3400 3100 2800 2500 2200 1900 1600 1300 ...</span>
<span class="co">#&gt;  $ cf         : num [1:13] 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 ...</span>
<span class="co">#&gt;  $ M          : num 0</span>
<span class="co">#&gt;  $ pvt        :'data.frame': 14 obs. of  9 variables:</span>
<span class="co">#&gt;   ..$ p  : num [1:14] 3700 3650 3400 3100 2800 2500 2200 1900 1600 1300 ...</span>
<span class="co">#&gt;   ..$ Bo : num [1:14] 10.06 2.42 2.19 1.92 1.74 ...</span>
<span class="co">#&gt;   ..$ Rs : num [1:14] 11566 2378 2010 1569 1272 ...</span>
<span class="co">#&gt;   ..$ Rv : num [1:14] 8.41e-05 8.41e-05 7.05e-05 5.62e-05 4.65e-05 ...</span>
<span class="co">#&gt;   ..$ Bg : num [1:14] 0.00087 0.00088 0.00092 0.00099 0.00108 0.0012 0.00135 0.00156 0.00185 0.00228 ...</span>
<span class="co">#&gt;   ..$ Bw : num [1:14] 10.1 10.1 10.1 10.1 10.1 ...</span>
<span class="co">#&gt;   ..$ muo: num [1:14] 0.0612 0.062 0.1338 0.1826 0.2354 ...</span>
<span class="co">#&gt;   ..$ mug: num [1:14] 0.0612 0.062 0.0554 0.0436 0.0368 0.0308 0.0261 0.0222 0.0191 0.0166 ...</span>
<span class="co">#&gt;   ..$ muw: num [1:14] 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 ...</span>
<span class="co">#&gt;  $ prod       :'data.frame': 13 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ Np: num [1:13] 0 28600 93000 231000 270000 ...</span>
<span class="co">#&gt;   ..$ Gp: num [1:13] 0.0 3.4e+08 1.2e+09 3.3e+09 4.3e+09 ...</span>
<span class="co">#&gt;   ..$ Wp: num [1:13] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ inj        :'data.frame': 13 obs. of  1 variable:</span>
<span class="co">#&gt;   ..$ Wi: num [1:13] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ We         : num [1:13] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ aquifer    :List of 3</span>
<span class="co">#&gt;   ..$ input_unit : chr "Field"</span>
<span class="co">#&gt;   ..$ output_unit: chr "Field"</span>
<span class="co">#&gt;   ..$ We         : num [1:13] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "NoA" "aquifer"</span>
<span class="co">#&gt;  $ wf         : num [1:13] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ sgrw       : num 0.15</span>
<span class="co">#&gt;  $ p_est      : num [1:13] 3700 3638 3459 3087 2928 ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "volumetric_gas" "mbal_gas"</span></pre></body></html></div>
</div>
<div id="part-ii-reservoir-performance" class="section level4">
<h4 class="hasAnchor">
<a href="#part-ii-reservoir-performance" class="anchor"></a><code>Part II: Reservoir Performance</code>
</h4>
<div class="sourceCode" id="cb3"><html><body><pre class="r">
<span class="no">mbal_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_perform_gas.html">mbal_perform_gas</a></span>(<span class="no">optim_results</span>, <span class="no">time_lst</span>)

<span class="no">mbal_results</span>
<span class="co">#&gt;    P (psia) Eo (bbl/STB) Eg (bbl/SCF) Ew (bbl/STB) Ef (bbl/bbl) Egwf (bbl/SCF)</span>
<span class="co">#&gt; 1      3700    0.0000000 0.000000e+00  0.000000000       0.0000   0.000000e+00</span>
<span class="co">#&gt; 2      3650    0.1320662 1.000000e-05  0.001507613       0.0001   1.014138e-05</span>
<span class="co">#&gt; 3      3400    0.6574474 5.543884e-05  0.009049071       0.0006   5.628718e-05</span>
<span class="co">#&gt; 4      3100    1.5325537 1.311046e-04  0.018106291       0.0012   1.328015e-04</span>
<span class="co">#&gt; 5      2800    2.6122256 2.244833e-04  0.027171665       0.0018   2.270288e-04</span>
<span class="co">#&gt; 6      2500    4.0130663 3.456791e-04  0.036245202       0.0024   3.490735e-04</span>
<span class="co">#&gt; 7      2200    5.7613484 4.968738e-04  0.045326909       0.0030   5.011172e-04</span>
<span class="co">#&gt; 8      1900    8.1827541 7.063101e-04  0.054416793       0.0036   7.114028e-04</span>
<span class="co">#&gt; 9      1600   11.5352122 9.962015e-04  0.063514862       0.0042   1.002144e-03</span>
<span class="co">#&gt; 10     1300   16.4682424 1.422867e-03  0.072621122       0.0048   1.429658e-03</span>
<span class="co">#&gt; 11     1000   24.1867133 2.090307e-03  0.081735582       0.0054   2.097949e-03</span>
<span class="co">#&gt; 12      700   37.3364090 3.227341e-03  0.090858249       0.0060   3.235832e-03</span>
<span class="co">#&gt; 13      600   44.1449393 3.816056e-03  0.093900963       0.0062   3.824830e-03</span>
<span class="co">#&gt;      Et (bbl)  F (bbl) We       Igd Inwd        Ifwd Iawd Itot     RF_oil</span>
<span class="co">#&gt; 1         0.0        0  0        NA   NA          NA   NA   NA 0.00000000</span>
<span class="co">#&gt; 2    244546.5   299200  0 0.9860593    0 0.013940655    0    1 0.01152429</span>
<span class="co">#&gt; 3   1357294.1  1107355  0 0.9849284    0 0.015071605    0    1 0.05619769</span>
<span class="co">#&gt; 4   3202339.9  3285114  0 0.9872226    0 0.012777361    0    1 0.11101389</span>
<span class="co">#&gt; 5   5474512.8  4670970  0 0.9887876    0 0.011212425    0    1 0.15600931</span>
<span class="co">#&gt; 6   8417466.8  7961572  0 0.9902759    0 0.009724057    0    1 0.19754688</span>
<span class="co">#&gt; 7  12083808.4 12343156  0 0.9915320    0 0.008467990    0    1 0.23215128</span>
<span class="co">#&gt; 8  17154579.3 16441143  0 0.9928414    0 0.007158640    0    1 0.26604491</span>
<span class="co">#&gt; 9  24165423.8 22263132  0 0.9940706    0 0.005929366    0    1 0.29378450</span>
<span class="co">#&gt; 10 34474400.5 29239665  0 0.9952495    0 0.004750542    0    1 0.33713256</span>
<span class="co">#&gt; 11 50589383.5 48424305  0 0.9963577    0 0.003642322    0    1 0.34765473</span>
<span class="co">#&gt; 12 78028003.4 78147206  0 0.9973758    0 0.002624158    0    1 0.37164849</span>
<span class="co">#&gt; 13 92230944.2 95961416  0 0.9977059    0 0.002294137    0    1 0.38049060</span>
<span class="co">#&gt;        RF_gas        SOg       SGg SWg        SOT       SGT SWT qo (STB/day)</span>
<span class="co">#&gt; 1  0.00000000 0.00000000 0.8000000 0.2 0.00000000 0.8000000 0.2      0.00000</span>
<span class="co">#&gt; 2  0.01152429 0.00000000 0.8000000 0.2 0.00000000 0.8000000 0.2     78.35616</span>
<span class="co">#&gt; 3  0.06099636 0.03081968 0.7691803 0.2 0.03081968 0.7691803 0.2    176.43836</span>
<span class="co">#&gt; 4  0.13340325 0.05019541 0.7498046 0.2 0.05019541 0.7498046 0.2    378.08219</span>
<span class="co">#&gt; 5  0.20899811 0.05785919 0.7421408 0.2 0.05785919 0.7421408 0.2    106.84932</span>
<span class="co">#&gt; 6  0.28937568 0.06103382 0.7389662 0.2 0.06103382 0.7389662 0.2    298.63014</span>
<span class="co">#&gt; 7  0.36944903 0.06151868 0.7384813 0.2 0.06151868 0.7384813 0.2    279.45205</span>
<span class="co">#&gt; 8  0.45433152 0.06031277 0.7396872 0.2 0.06031277 0.7396872 0.2     99.17808</span>
<span class="co">#&gt; 9  0.54016310 0.05791260 0.7420874 0.2 0.05791260 0.7420874 0.2     87.12329</span>
<span class="co">#&gt; 10 0.62584935 0.05444033 0.7455597 0.2 0.05444033 0.7455597 0.2     84.93151</span>
<span class="co">#&gt; 11 0.71051843 0.05289869 0.7471013 0.2 0.05289869 0.7471013 0.2    260.27397</span>
<span class="co">#&gt; 12 0.79087148 0.04988085 0.7501191 0.2 0.04988085 0.7501191 0.2    219.17808</span>
<span class="co">#&gt; 13 0.81708903 0.04878615 0.7512138 0.2 0.04878615 0.7512138 0.2    131.50685</span>
<span class="co">#&gt;    qg (SCF/day) qw (STB/day)          fo fw GOR (SCF/STB) kro/krg</span>
<span class="co">#&gt; 1           0.0            0 0.000000000  0      11888.11       0</span>
<span class="co">#&gt; 2      931506.8            0 0.000000000  0      11888.11       0</span>
<span class="co">#&gt; 3     2356164.4            0 0.022742723  0      13354.04       0</span>
<span class="co">#&gt; 4     5753424.7            0 0.033095319  0      15217.39       0</span>
<span class="co">#&gt; 5     2739726.0            0 0.037904222  0      25641.03       0</span>
<span class="co">#&gt; 6     6301369.9            0 0.027491083  0      21100.92       0</span>
<span class="co">#&gt; 7     6849315.1            0 0.023974224  0      24509.80       0</span>
<span class="co">#&gt; 8     3835616.4            0 0.018973378  0      38674.03       0</span>
<span class="co">#&gt; 9     4109589.0            0 0.008598187  0      47169.81       0</span>
<span class="co">#&gt; 10    2191780.8            0 0.021894547  0      25806.45       0</span>
<span class="co">#&gt; 11    9863013.7            0 0.000000000  0      37894.74       0</span>
<span class="co">#&gt; 12    7397260.3            0 0.000000000  0      33750.00       0</span>
<span class="co">#&gt; 13    3835616.4            0 0.000000000  0      29166.67       0</span></pre></body></html></div>
</div>
<div id="part-iii-reservoir-forecast" class="section level4">
<h4 class="hasAnchor">
<a href="#part-iii-reservoir-forecast" class="anchor"></a><code>Part III: Reservoir Forecast</code>
</h4>
<div class="sourceCode" id="cb4"><html><body><pre class="r">
<span class="co"># Step I: generating a set of pseudo relative permeability curves using </span>
<span class="co"># laboratory 'Kr' values</span>

<span class="no">sg_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.152</span>, <span class="fl">0.248</span>, <span class="fl">0.352</span>, <span class="fl">0.448</span>, <span class="fl">0.552</span>, <span class="fl">0.65</span>)

<span class="no">krg_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.09</span>, <span class="fl">0.18</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">1</span>)

<span class="no">kro_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0.6</span>, <span class="fl">0.35</span>, <span class="fl">0.13</span>, <span class="fl">0.04</span>, <span class="fl">0.01</span>, <span class="fl">0</span>)

<span class="no">swcrit_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.2</span>

<span class="no">sgcrit_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.05</span>

<span class="no">sorgr_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.15</span>

<span class="no">fun_kr</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">swcrit</span>, <span class="no">sgcrit</span>, <span class="no">sorg</span>, <span class="no">sg</span>, <span class="no">krg</span>, <span class="no">kro</span>) {

  <span class="no">kr_est</span> <span class="kw">&lt;-</span> <span class="kw pkg">Rrelperm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rrelperm/man/kr2p_gl.html">kr2p_gl</a></span>(<span class="kw">SWCON</span> <span class="kw">=</span> <span class="no">swcrit</span>, <span class="kw">SOIRG</span> <span class="kw">=</span> <span class="no">sorg</span>, <span class="kw">SORG</span> <span class="kw">=</span> <span class="no">sorg</span>,
                               <span class="kw">SGCON</span> <span class="kw">=</span> <span class="no">sgcrit</span>, <span class="kw">SGCRIT</span> <span class="kw">=</span> <span class="no">sgcrit</span>, <span class="kw">KRGCL</span> <span class="kw">=</span> <span class="fl">1</span>,
                               <span class="kw">KROGCG</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">NG</span> <span class="kw">=</span> <span class="no">x</span>[<span class="fl">1</span>], <span class="kw">NOG</span> <span class="kw">=</span> <span class="no">x</span>[<span class="fl">2</span>], <span class="kw">NP</span> <span class="kw">=</span> <span class="fl">101</span>)

   <span class="no">krg_est_sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">1</span>], <span class="kw">y</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">3</span>], <span class="kw">xout</span> <span class="kw">=</span> <span class="no">sg</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="fl">2</span>)$<span class="no">y</span>

   <span class="no">kro_est_sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">1</span>], <span class="kw">y</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">4</span>], <span class="kw">xout</span> <span class="kw">=</span> <span class="no">sg</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="fl">2</span>)$<span class="no">y</span>

   <span class="no">error</span> <span class="kw">&lt;-</span> (<span class="no">krg</span> - <span class="no">krg_est_sub</span>) ^ <span class="fl">2</span> + (<span class="no">kro</span> - <span class="no">kro_est_sub</span>) ^ <span class="fl">2</span>

   <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">error</span>)
}

<span class="no">par</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>)

<span class="no">opt_results</span> <span class="kw">&lt;-</span> <span class="kw pkg">minpack.lm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html">nls.lm</a></span>(<span class="kw">par</span> <span class="kw">=</span> <span class="no">par</span>, <span class="kw">fn</span> <span class="kw">=</span> <span class="no">fun_kr</span>, <span class="kw">swcrit</span> <span class="kw">=</span> <span class="no">swcrit_lab</span>,
                                  <span class="kw">sgcrit</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>, <span class="kw">sorg</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>, <span class="kw">sg</span> <span class="kw">=</span> <span class="no">sg_lab</span>,
                                  <span class="kw">krg</span> <span class="kw">=</span> <span class="no">krg_lab</span>, <span class="kw">kro</span> <span class="kw">=</span> <span class="no">kro_lab</span>,
                                  <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">10</span>))

<span class="no">sol</span> <span class="kw">&lt;-</span> <span class="no">opt_results</span>$<span class="no">par</span>

<span class="no">sol</span>
<span class="co">#&gt; [1] 3.157478 2.740570</span>

<span class="no">rel_perm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw pkg">Rrelperm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rrelperm/man/kr2p_gl.html">kr2p_gl</a></span>(<span class="kw">SWCON</span> <span class="kw">=</span> <span class="no">swcrit_lab</span>, <span class="kw">SOIRG</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>,
                                            <span class="kw">SORG</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>, <span class="kw">SGCON</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>,
                                            <span class="kw">SGCRIT</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>, <span class="kw">KRGCL</span> <span class="kw">=</span> <span class="fl">1</span>,
                                            <span class="kw">KROGCG</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">NG</span> <span class="kw">=</span> <span class="no">sol</span>[<span class="fl">1</span>], <span class="kw">NOG</span> <span class="kw">=</span> <span class="no">sol</span>[<span class="fl">2</span>],
                                            <span class="kw">NP</span> <span class="kw">=</span> <span class="fl">101</span>))

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rel_perm</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Sg"</span>, <span class="st">"Sl"</span>, <span class="st">"Krg"</span>, <span class="st">"Krog"</span>)

<span class="no">p_forecast</span> <span class="kw">&lt;-</span> <span class="no">p</span>

<span class="no">wf_forecast</span> <span class="kw">&lt;-</span> <span class="no">wf</span>

<span class="no">time_lst_forecast</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_time.html">mbal_time</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p_forecast</span>)), <span class="st">"year"</span>)

<span class="no">forecast_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_forecast_param_gas.html">mbal_forecast_param_gas</a></span>(<span class="kw">input_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>, <span class="kw">output_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>,
                                        <span class="kw">G</span> <span class="kw">=</span> <span class="fl">2.41e10</span>, <span class="kw">phi</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">swi</span> <span class="kw">=</span> <span class="fl">0.2</span>,
                                        <span class="kw">pd</span> <span class="kw">=</span> <span class="fl">3650</span>, <span class="kw">p</span> <span class="kw">=</span> <span class="no">p_forecast</span>, <span class="kw">pvt</span> <span class="kw">=</span> <span class="no">pvt_table</span>,
                                        <span class="kw">M</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">cf</span> <span class="kw">=</span> <span class="fl">2e-6</span>, <span class="kw">wf</span> <span class="kw">=</span> <span class="no">wf_forecast</span>,
                                        <span class="kw">rel_perm</span> <span class="kw">=</span> <span class="no">rel_perm</span>)

<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="no">forecast_lst</span>)
<span class="co">#&gt; List of 12</span>
<span class="co">#&gt;  $ input_unit : chr "Field"</span>
<span class="co">#&gt;  $ output_unit: chr "Field"</span>
<span class="co">#&gt;  $ G          : num 2.41e+10</span>
<span class="co">#&gt;  $ phi        : num 0.1</span>
<span class="co">#&gt;  $ swi        : num 0.2</span>
<span class="co">#&gt;  $ pd         : num 3650</span>
<span class="co">#&gt;  $ p          : num [1:13] 3700 3650 3400 3100 2800 2500 2200 1900 1600 1300 ...</span>
<span class="co">#&gt;  $ cf         : num [1:13] 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 ...</span>
<span class="co">#&gt;  $ M          : num 0</span>
<span class="co">#&gt;  $ pvt        :'data.frame': 14 obs. of  9 variables:</span>
<span class="co">#&gt;   ..$ p  : num [1:14] 3700 3650 3400 3100 2800 2500 2200 1900 1600 1300 ...</span>
<span class="co">#&gt;   ..$ Bo : num [1:14] 10.06 2.42 2.19 1.92 1.74 ...</span>
<span class="co">#&gt;   ..$ Rs : num [1:14] 11566 2378 2010 1569 1272 ...</span>
<span class="co">#&gt;   ..$ Rv : num [1:14] 8.41e-05 8.41e-05 7.05e-05 5.62e-05 4.65e-05 ...</span>
<span class="co">#&gt;   ..$ Bg : num [1:14] 0.00087 0.00088 0.00092 0.00099 0.00108 0.0012 0.00135 0.00156 0.00185 0.00228 ...</span>
<span class="co">#&gt;   ..$ Bw : num [1:14] 10.1 10.1 10.1 10.1 10.1 ...</span>
<span class="co">#&gt;   ..$ muo: num [1:14] 0.0612 0.062 0.1338 0.1826 0.2354 ...</span>
<span class="co">#&gt;   ..$ mug: num [1:14] 0.0612 0.062 0.0554 0.0436 0.0368 0.0308 0.0261 0.0222 0.0191 0.0166 ...</span>
<span class="co">#&gt;   ..$ muw: num [1:14] 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 ...</span>
<span class="co">#&gt;  $ wf         : num [1:13] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ rel_perm   :'data.frame': 101 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ Sg  : num [1:101] 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 ...</span>
<span class="co">#&gt;   ..$ Sl  : num [1:101] 1 0.99 0.98 0.97 0.96 0.95 0.94 0.93 0.92 0.91 ...</span>
<span class="co">#&gt;   ..$ Krg : num [1:101] 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ Krog: num [1:101] 1 1 1 1 1 ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "volumetric_forecast_gas" "forecast_gas"</span>

<span class="no">forecast_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_forecast_gas.html">mbal_forecast_gas</a></span>(<span class="no">forecast_lst</span>, <span class="no">time_lst_forecast</span>)

<span class="no">forecast_results</span>
<span class="co">#&gt;    P (psia)        SOg       SGg SWg        SOT       SGT SWT GOR (SCF/STB)</span>
<span class="co">#&gt; 1      3700 0.00000000 0.8000000 0.2 0.00000000 0.8000000 0.2      11888.11</span>
<span class="co">#&gt; 2      3650 0.00000000 0.8000000 0.2 0.00000000 0.8000000 0.2      11888.11</span>
<span class="co">#&gt; 3      3400 0.03068653 0.7693135 0.2 0.03068653 0.7693135 0.2      14184.40</span>
<span class="co">#&gt; 4      3100 0.05013281 0.7498672 0.2 0.05013281 0.7498672 0.2      17793.59</span>
<span class="co">#&gt; 5      2800 0.05761899 0.7423810 0.2 0.05761899 0.7423810 0.2      21505.38</span>
<span class="co">#&gt; 6      2500 0.06091994 0.7390801 0.2 0.06091994 0.7390801 0.2      25316.46</span>
<span class="co">#&gt; 7      2200 0.06143071 0.7385693 0.2 0.06143071 0.7385693 0.2      29585.80</span>
<span class="co">#&gt; 8      1900 0.06042696 0.7395730 0.2 0.06042696 0.7395730 0.2      33444.82</span>
<span class="co">#&gt; 9      1600 0.05786851 0.7421315 0.2 0.05786851 0.7421315 0.2      36630.04</span>
<span class="co">#&gt; 10     1300 0.05603136 0.7439686 0.2 0.05603136 0.7439686 0.2      39215.69</span>
<span class="co">#&gt; 11     1000 0.05296314 0.7470369 0.2 0.05296314 0.7470369 0.2      38610.04</span>
<span class="co">#&gt; 12      700 0.04977272 0.7502273 0.2 0.04977272 0.7502273 0.2      35335.69</span>
<span class="co">#&gt; 13      600 0.04866108 0.7513389 0.2 0.04866108 0.7513389 0.2      33557.05</span>
<span class="co">#&gt;        RF_oil     RF_gas Liq_volume       Igd Inwd        Ifwd Iawd Itot</span>
<span class="co">#&gt; 1  0.00000000 0.00000000 0.00000000        NA   NA          NA   NA   NA</span>
<span class="co">#&gt; 2  0.01152429 0.01152429 0.00000000 0.9860593    0 0.013940655    0    1</span>
<span class="co">#&gt; 3  0.05685112 0.06097174 0.03758014 0.9849284    0 0.015071605    0    1</span>
<span class="co">#&gt; 4  0.11139035 0.13339023 0.05859826 0.9872226    0 0.012777361    0    1</span>
<span class="co">#&gt; 5  0.15766441 0.20894764 0.06341777 0.9887876    0 0.011212425    0    1</span>
<span class="co">#&gt; 6  0.19840889 0.28935420 0.06195818 0.9902759    0 0.009724057    0    1</span>
<span class="co">#&gt; 7  0.23287900 0.36943370 0.05704894 0.9915320    0 0.008467990    0    1</span>
<span class="co">#&gt; 8  0.26503067 0.45434807 0.04977378 0.9928414    0 0.007158640    0    1</span>
<span class="co">#&gt; 9  0.29420592 0.54015762 0.04100334 0.9940706    0 0.005929366    0    1</span>
<span class="co">#&gt; 10 0.32114068 0.62597917 0.03280231 0.9952495    0 0.004750542    0    1</span>
<span class="co">#&gt; 11 0.34697055 0.71052189 0.02391379 0.9963577    0 0.003642322    0    1</span>
<span class="co">#&gt; 12 0.37285555 0.79086821 0.01576379 0.9973758    0 0.002624158    0    1</span>
<span class="co">#&gt; 13 0.38190992 0.81708618 0.01319553 0.9977059    0 0.002294137    0    1</span>

<span class="no">p1</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">SOg</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">mbal_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">SOg</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Condensate Saturation Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p1</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">

<span class="no">p2</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`GOR (SCF/STB)`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">mbal_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`GOR (SCF/STB)`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"GOR Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p2</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-4-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">

<span class="no">p3</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`RF_oil`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">mbal_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`RF_oil`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Condensate Recovery Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p3</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-4-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">

<span class="no">p4</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`Liq_volume`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"CCE Liquid Volume Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p4</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-4-4.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">

<span class="no">p5</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span>  <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span>(<span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Igd"</span>, <span class="st">"Ifwd"</span>), <span class="kw">names_to</span> <span class="kw">=</span> <span class="st">"Drive Mechanism"</span>,
                      <span class="kw">values_to</span> <span class="kw">=</span> <span class="st">"Fraction"</span>, <span class="kw">values_drop_na</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">Fraction</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">`Drive Mechanism`</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Energy Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p5</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-4-5.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="example-2-lean-gas-condensate-reservoir-walsh1994a" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2-lean-gas-condensate-reservoir-walsh1994a" class="anchor"></a><code>Example 2: Lean Gas Condensate Reservoir</code> <font size="2"> <span class="citation">(Walsh, Ansah, &amp; Raghavan, 1994)</span> </font>
</h2>
<div id="part-i-reservoir-forecast" class="section level3">
<h3 class="hasAnchor">
<a href="#part-i-reservoir-forecast" class="anchor"></a><code>Part I: Reservoir Forecast</code>
</h3>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rmbal</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rrelperm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pracma</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)

<span class="no">p_pvt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8000</span>, <span class="fl">7500</span>, <span class="fl">7280</span>, <span class="fl">7250</span>, <span class="fl">7000</span>, <span class="fl">6500</span>, <span class="fl">6000</span>, <span class="fl">5500</span>, <span class="fl">5000</span>, <span class="fl">4500</span>, <span class="fl">4000</span>, <span class="fl">3500</span>,
           <span class="fl">3000</span>,    <span class="fl">2500</span>,   <span class="fl">2000</span>,   <span class="fl">1500</span>,   <span class="fl">1000</span>) <span class="co"># psia</span>

<span class="no">Bo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">12.732</span>, <span class="fl">13.044</span>, <span class="fl">13.192</span>, <span class="fl">1.054</span>, <span class="fl">1.041</span>,   <span class="fl">1.018</span>,  <span class="fl">1.002</span>,  <span class="fl">0.983</span>,  <span class="fl">0.965</span>, <span class="fl">0.947</span>,
        <span class="fl">0.93</span>,   <span class="fl">0.913</span>,  <span class="fl">0.896</span>,  <span class="fl">0.877</span>,  <span class="fl">0.858</span>,  <span class="fl">0.839</span>,  <span class="fl">0.819</span>) <span class="co"># RB/STB</span>

<span class="no">Rs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">22527</span>,  <span class="fl">22527</span>,  <span class="fl">22527</span>,  <span class="fl">860</span>,    <span class="fl">819</span>,    <span class="fl">754</span>,    <span class="fl">704</span>,    <span class="fl">648</span>,    <span class="fl">593</span>,    <span class="fl">541</span>, <span class="fl">490</span>, <span class="fl">440</span>,
        <span class="fl">389</span>,    <span class="fl">336</span>,    <span class="fl">280</span>,    <span class="fl">228</span>,    <span class="fl">169</span>) <span class="co">#SCF/STB</span>

<span class="no">Bg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.565</span>,  <span class="fl">0.579</span>,  <span class="fl">0.586</span>,  <span class="fl">0.587</span>,  <span class="fl">0.595</span>,  <span class="fl">0.613</span>,  <span class="fl">0.634</span>,  <span class="fl">0.661</span>, <span class="fl">0.694</span>, <span class="fl">0.737</span>,
        <span class="fl">0.795</span>,  <span class="fl">0.817</span>,  <span class="fl">0.997</span>,  <span class="fl">1.178</span>,  <span class="fl">1.466</span>,  <span class="fl">1.963</span>, <span class="fl">2.912</span>) / <span class="fl">1000</span> <span class="co"># RB/SCF</span>

<span class="no">Rv</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">44.4</span>,   <span class="fl">44.4</span>,   <span class="fl">44.4</span>,   <span class="fl">44.3</span>,   <span class="fl">43.9</span>,   <span class="fl">40.3</span>,   <span class="fl">36.5</span>,   <span class="fl">32.9</span>,   <span class="fl">29.2</span>,   <span class="fl">25.4</span>,   <span class="fl">21.4</span>,   <span class="fl">17.6</span>,
        <span class="fl">13.7</span>, <span class="fl">10.5</span>, <span class="fl">7.9</span>, <span class="fl">5.8</span>,   <span class="fl">4.4</span>) / <span class="fl">1e6</span> <span class="co"># STB/SCF</span>

<span class="no">cw</span> <span class="kw">&lt;-</span> <span class="fl">2e-6</span>

<span class="no">Bwi</span> <span class="kw">&lt;-</span> <span class="fl">1.0</span>

<span class="no">Bw</span> <span class="kw">&lt;-</span> <span class="no">Bwi</span> * <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">cw</span> * (<span class="no">p_pvt</span>[<span class="fl">1</span>] - <span class="no">p_pvt</span>))


<span class="no">muo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.049</span>, <span class="fl">0.047</span>,  <span class="fl">0.046</span>,  <span class="fl">19.541</span>, <span class="fl">20.965</span>, <span class="fl">23.958</span>, <span class="fl">26.338</span>, <span class="fl">29.633</span>, <span class="fl">33.319</span>,
         <span class="fl">37.401</span>, <span class="fl">42.161</span>,    <span class="fl">47.465</span>, <span class="fl">53.765</span>, <span class="fl">61.887</span>, <span class="fl">72.143</span>, <span class="fl">83.478</span>, <span class="fl">99.049</span>)  <span class="co"># cp</span>

<span class="no">muw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.25</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p_pvt</span>))

<span class="no">mug</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.049</span>, <span class="fl">0.047</span>,  <span class="fl">0.046</span>,  <span class="fl">0.046</span>,  <span class="fl">0.0449</span>, <span class="fl">0.042</span>,  <span class="fl">0.0393</span>, <span class="fl">0.0366</span>, <span class="fl">0.0339</span>,
         <span class="fl">0.0312</span>,    <span class="fl">0.0283</span>, <span class="fl">0.0254</span>, <span class="fl">0.0225</span>, <span class="fl">0.0198</span>, <span class="fl">0.0174</span>, <span class="fl">0.0154</span>, <span class="fl">0.014</span>) <span class="co"># cp</span>

<span class="no">pvt_table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="no">p_pvt</span>, <span class="kw">Bo</span> <span class="kw">=</span> <span class="no">Bo</span>, <span class="kw">Rs</span> <span class="kw">=</span> <span class="no">Rs</span>, <span class="kw">Rv</span> <span class="kw">=</span> <span class="no">Rv</span>, <span class="kw">Bg</span> <span class="kw">=</span> <span class="no">Bg</span>,
                               <span class="kw">Bw</span> <span class="kw">=</span> <span class="no">Bw</span>, <span class="kw">muo</span> <span class="kw">=</span> <span class="no">muo</span>, <span class="kw">mug</span> <span class="kw">=</span> <span class="no">mug</span>, <span class="kw">muw</span> <span class="kw">=</span> <span class="no">muw</span>)

<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8000</span>,    <span class="fl">7500</span>,   <span class="fl">7280</span>,   <span class="fl">7250</span>,   <span class="fl">7000</span>,   <span class="fl">6500</span>,   <span class="fl">6000</span>,   <span class="fl">5500</span>,   <span class="fl">5000</span>,   <span class="fl">4500</span>,   <span class="fl">4000</span>,   <span class="fl">3500</span>,
           <span class="fl">3000</span>,    <span class="fl">2500</span>,   <span class="fl">2000</span>,   <span class="fl">1500</span>,   <span class="fl">1000</span>) <span class="co"># psia</span>

<span class="no">Gi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">wf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="co"># generating a set of pseudo relative permeability curves using </span>
<span class="co"># laboratory 'Kr' values</span>

<span class="no">sg_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.152</span>, <span class="fl">0.248</span>, <span class="fl">0.352</span>, <span class="fl">0.448</span>, <span class="fl">0.552</span>, <span class="fl">0.65</span>)

<span class="no">krg_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.09</span>, <span class="fl">0.18</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">1</span>)

<span class="no">kro_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0.6</span>, <span class="fl">0.35</span>, <span class="fl">0.13</span>, <span class="fl">0.04</span>, <span class="fl">0.01</span>, <span class="fl">0</span>)

<span class="no">swcrit_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.2</span>

<span class="no">sgcrit_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.05</span>

<span class="no">sorgr_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.15</span>

<span class="no">fun_kr</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">swcrit</span>, <span class="no">sgcrit</span>, <span class="no">sorg</span>, <span class="no">sg</span>, <span class="no">krg</span>, <span class="no">kro</span>) {

  <span class="no">kr_est</span> <span class="kw">&lt;-</span> <span class="kw pkg">Rrelperm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rrelperm/man/kr2p_gl.html">kr2p_gl</a></span>(<span class="kw">SWCON</span> <span class="kw">=</span> <span class="no">swcrit</span>, <span class="kw">SOIRG</span> <span class="kw">=</span> <span class="no">sorg</span>, <span class="kw">SORG</span> <span class="kw">=</span> <span class="no">sorg</span>,
                               <span class="kw">SGCON</span> <span class="kw">=</span> <span class="no">sgcrit</span>, <span class="kw">SGCRIT</span> <span class="kw">=</span> <span class="no">sgcrit</span>, <span class="kw">KRGCL</span> <span class="kw">=</span> <span class="fl">1</span>,
                               <span class="kw">KROGCG</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">NG</span> <span class="kw">=</span> <span class="no">x</span>[<span class="fl">1</span>], <span class="kw">NOG</span> <span class="kw">=</span> <span class="no">x</span>[<span class="fl">2</span>], <span class="kw">NP</span> <span class="kw">=</span> <span class="fl">101</span>)

   <span class="no">krg_est_sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">1</span>], <span class="kw">y</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">3</span>], <span class="kw">xout</span> <span class="kw">=</span> <span class="no">sg</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="fl">2</span>)$<span class="no">y</span>

   <span class="no">kro_est_sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">1</span>], <span class="kw">y</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">4</span>], <span class="kw">xout</span> <span class="kw">=</span> <span class="no">sg</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="fl">2</span>)$<span class="no">y</span>

   <span class="no">error</span> <span class="kw">&lt;-</span> (<span class="no">krg</span> - <span class="no">krg_est_sub</span>) ^ <span class="fl">2</span> + (<span class="no">kro</span> - <span class="no">kro_est_sub</span>) ^ <span class="fl">2</span>

   <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">error</span>)
}

<span class="no">par</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>)

<span class="no">opt_results</span> <span class="kw">&lt;-</span> <span class="kw pkg">minpack.lm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html">nls.lm</a></span>(<span class="kw">par</span> <span class="kw">=</span> <span class="no">par</span>, <span class="kw">fn</span> <span class="kw">=</span> <span class="no">fun_kr</span>, <span class="kw">swcrit</span> <span class="kw">=</span> <span class="no">swcrit_lab</span>,
                                  <span class="kw">sgcrit</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>, <span class="kw">sorg</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>, <span class="kw">sg</span> <span class="kw">=</span> <span class="no">sg_lab</span>,
                                  <span class="kw">krg</span> <span class="kw">=</span> <span class="no">krg_lab</span>, <span class="kw">kro</span> <span class="kw">=</span> <span class="no">kro_lab</span>,
                                  <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">10</span>))

<span class="no">sol</span> <span class="kw">&lt;-</span> <span class="no">opt_results</span>$<span class="no">par</span>

<span class="no">sol</span>
<span class="co">#&gt; [1] 3.157478 2.740570</span>

<span class="no">rel_perm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw pkg">Rrelperm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rrelperm/man/kr2p_gl.html">kr2p_gl</a></span>(<span class="kw">SWCON</span> <span class="kw">=</span> <span class="no">swcrit_lab</span>, <span class="kw">SOIRG</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>,
                                            <span class="kw">SORG</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>, <span class="kw">SGCON</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>,
                                            <span class="kw">SGCRIT</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>, <span class="kw">KRGCL</span> <span class="kw">=</span> <span class="fl">1</span>,
                                            <span class="kw">KROGCG</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">NG</span> <span class="kw">=</span> <span class="no">sol</span>[<span class="fl">1</span>], <span class="kw">NOG</span> <span class="kw">=</span> <span class="no">sol</span>[<span class="fl">2</span>],
                                            <span class="kw">NP</span> <span class="kw">=</span> <span class="fl">101</span>))

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rel_perm</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Sg"</span>, <span class="st">"Sl"</span>, <span class="st">"Krg"</span>, <span class="st">"Krog"</span>)

<span class="no">p_forecast</span> <span class="kw">&lt;-</span> <span class="no">p</span>

<span class="no">Gi_forecast</span> <span class="kw">&lt;-</span> <span class="no">Gi</span>

<span class="no">wf_forecast</span> <span class="kw">&lt;-</span> <span class="no">wf</span>

<span class="no">time_lst_forecast</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_time.html">mbal_time</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p_forecast</span>)), <span class="st">"year"</span>)

<span class="no">forecast_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_forecast_param_gas.html">mbal_forecast_param_gas</a></span>(<span class="kw">input_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>, <span class="kw">output_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>,
                                        <span class="kw">G</span> <span class="kw">=</span> <span class="fl">1e6</span>, <span class="kw">phi</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">swi</span> <span class="kw">=</span> <span class="fl">0.2</span>,
                                        <span class="kw">pd</span> <span class="kw">=</span> <span class="fl">7255</span>, <span class="kw">p</span> <span class="kw">=</span> <span class="no">p_forecast</span>, <span class="kw">pvt</span> <span class="kw">=</span> <span class="no">pvt_table</span>,
                                        <span class="kw">M</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">cf</span> <span class="kw">=</span> <span class="fl">2e-6</span>, <span class="kw">wf</span> <span class="kw">=</span> <span class="no">wf_forecast</span>,
                                        <span class="kw">rel_perm</span> <span class="kw">=</span> <span class="no">rel_perm</span>)

<span class="no">forecast_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_forecast_gas.html">mbal_forecast_gas</a></span>(<span class="no">forecast_lst</span>, <span class="no">time_lst_forecast</span>)

<span class="no">forecast_results</span>
<span class="co">#&gt;    P (psia)           SOg       SGg SWg           SOT       SGT SWT</span>
<span class="co">#&gt; 1      8000  0.000000e+00 0.8000000 0.2  0.000000e+00 0.8000000 0.2</span>
<span class="co">#&gt; 2      7500  0.000000e+00 0.8000000 0.2  0.000000e+00 0.8000000 0.2</span>
<span class="co">#&gt; 3      7280  0.000000e+00 0.8000000 0.2  0.000000e+00 0.8000000 0.2</span>
<span class="co">#&gt; 4      7250 -6.445867e-06 0.8000064 0.2 -6.445867e-06 0.8000064 0.2</span>
<span class="co">#&gt; 5      7000  5.302536e-04 0.7994697 0.2  5.302536e-04 0.7994697 0.2</span>
<span class="co">#&gt; 6      6500  5.429192e-03 0.7945708 0.2  5.429192e-03 0.7945708 0.2</span>
<span class="co">#&gt; 7      6000  1.023873e-02 0.7897613 0.2  1.023873e-02 0.7897613 0.2</span>
<span class="co">#&gt; 8      5500  1.437797e-02 0.7856220 0.2  1.437797e-02 0.7856220 0.2</span>
<span class="co">#&gt; 9      5000  1.826115e-02 0.7817389 0.2  1.826115e-02 0.7817389 0.2</span>
<span class="co">#&gt; 10     4500  2.185398e-02 0.7781460 0.2  2.185398e-02 0.7781460 0.2</span>
<span class="co">#&gt; 11     4000  2.525091e-02 0.7747491 0.2  2.525091e-02 0.7747491 0.2</span>
<span class="co">#&gt; 12     3500  2.809971e-02 0.7719003 0.2  2.809971e-02 0.7719003 0.2</span>
<span class="co">#&gt; 13     3000  3.051476e-02 0.7694852 0.2  3.051476e-02 0.7694852 0.2</span>
<span class="co">#&gt; 14     2500  3.181549e-02 0.7681845 0.2  3.181549e-02 0.7681845 0.2</span>
<span class="co">#&gt; 15     2000  3.238901e-02 0.7676110 0.2  3.238901e-02 0.7676110 0.2</span>
<span class="co">#&gt; 16     1500  3.243476e-02 0.7675652 0.2  3.243476e-02 0.7675652 0.2</span>
<span class="co">#&gt; 17     1000  3.201427e-02 0.7679857 0.2  3.201427e-02 0.7679857 0.2</span>
<span class="co">#&gt;    GOR (SCF/STB)     RF_oil     RF_gas   Liq_volume       Igd Inwd        Ifwd</span>
<span class="co">#&gt; 1       22522.52 0.00000000 0.00000000 0.0000000000        NA   NA          NA</span>
<span class="co">#&gt; 2       22522.52 0.02564347 0.02564347 0.0000000000 0.9429152    0 0.057084803</span>
<span class="co">#&gt; 3       22522.52 0.03791902 0.03791902 0.0000000000 0.9450713    0 0.054928735</span>
<span class="co">#&gt; 4       22573.36 0.03973609 0.03973814 0.0001866506 0.9454998    0 0.054500241</span>
<span class="co">#&gt; 5       22779.04 0.05363364 0.05373023 0.0009069775 0.9469934    0 0.053006646</span>
<span class="co">#&gt; 6       24813.90 0.08425990 0.08602965 0.0069953671 0.9519195    0 0.048080480</span>
<span class="co">#&gt; 7       27397.26 0.11423483 0.12068817 0.0127243519 0.9559001    0 0.044099860</span>
<span class="co">#&gt; 8       30395.14 0.14535094 0.16050244 0.0173040403 0.9602905    0 0.039709533</span>
<span class="co">#&gt; 9       34246.58 0.17580192 0.20404587 0.0212457921 0.9643350    0 0.035664961</span>
<span class="co">#&gt; 10      39370.08 0.20634170 0.25371497 0.0244042383 0.9685092    0 0.031490803</span>
<span class="co">#&gt; 11      46728.97 0.23638478 0.31100541 0.0267678152 0.9727908    0 0.027209242</span>
<span class="co">#&gt; 12      56818.18 0.24593832 0.33262872 0.0296404337 0.9722007    0 0.027799347</span>
<span class="co">#&gt; 13      72992.70 0.29008639 0.45412713 0.0273081939 0.9814057    0 0.018594281</span>
<span class="co">#&gt; 14      95238.10 0.31403419 0.53879463 0.0249801618 0.9853905    0 0.014609455</span>
<span class="co">#&gt; 15     126582.28 0.33373997 0.62969713 0.0211731296 0.9890246    0 0.010975366</span>
<span class="co">#&gt; 16     172413.79 0.34899766 0.72324482 0.0163934081 0.9922554    0 0.007744562</span>
<span class="co">#&gt; 17     227272.73 0.35976398 0.81315547 0.0112080103 0.9949920    0 0.005008048</span>
<span class="co">#&gt;    Iawd Itot</span>
<span class="co">#&gt; 1    NA   NA</span>
<span class="co">#&gt; 2     0    1</span>
<span class="co">#&gt; 3     0    1</span>
<span class="co">#&gt; 4     0    1</span>
<span class="co">#&gt; 5     0    1</span>
<span class="co">#&gt; 6     0    1</span>
<span class="co">#&gt; 7     0    1</span>
<span class="co">#&gt; 8     0    1</span>
<span class="co">#&gt; 9     0    1</span>
<span class="co">#&gt; 10    0    1</span>
<span class="co">#&gt; 11    0    1</span>
<span class="co">#&gt; 12    0    1</span>
<span class="co">#&gt; 13    0    1</span>
<span class="co">#&gt; 14    0    1</span>
<span class="co">#&gt; 15    0    1</span>
<span class="co">#&gt; 16    0    1</span>
<span class="co">#&gt; 17    0    1</span>


<span class="no">reservoir_performance_table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="no">p</span>)

<span class="no">reservoir_performance_table</span>$<span class="no">`RF_oil`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,    <span class="fl">2.4</span>,    <span class="fl">3.5</span>,    <span class="fl">4.2</span>,    <span class="fl">5.8</span>, <span class="fl">7.6</span>,   <span class="fl">10.4</span>,
                                                <span class="fl">13.8</span>,   <span class="fl">16.6</span>,   <span class="fl">20</span>, <span class="fl">23.1</span>,   <span class="fl">25.9</span>,   <span class="fl">28.5</span>,   <span class="fl">30.8</span>,
                                                <span class="fl">32.7</span>,   <span class="fl">34.1</span>,   <span class="fl">35.2</span>) / <span class="fl">100</span>

<span class="no">reservoir_performance_table</span>$<span class="no">`Sg`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>,  <span class="fl">100</span>,    <span class="fl">100</span>,    <span class="fl">99.99</span>,  <span class="fl">99.91</span>,  <span class="fl">99.29</span>,  <span class="fl">98.68</span>,
                                      <span class="fl">98.15</span>,    <span class="fl">97.66</span>,  <span class="fl">97.21</span>,  <span class="fl">96.79</span>,  <span class="fl">96.45</span>,  <span class="fl">96.15</span>,
                                      <span class="fl">95.99</span>,    <span class="fl">95.9</span>,   <span class="fl">95.9</span>, <span class="fl">95.95</span>) * <span class="fl">0.8</span> / <span class="fl">100</span>


<span class="no">reservoir_performance_table</span>$<span class="no">`GOR`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">22.53</span>,   <span class="fl">22.53</span>, <span class="fl">22.53</span>, <span class="fl">22.55</span>, <span class="fl">22.78</span>, <span class="fl">24.81</span>,
                                       <span class="fl">27.4</span>, <span class="fl">30.4</span>, <span class="fl">34.25</span>,   <span class="fl">39.37</span>, <span class="fl">46.73</span>, <span class="fl">56.82</span>, <span class="fl">72.99</span>,
                                       <span class="fl">95.24</span>, <span class="fl">126.58</span>, <span class="fl">172.41</span>, <span class="fl">227.27</span>) * <span class="fl">1000</span> <span class="co"># SCF/STB</span>


<span class="no">p1</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">SGg</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">reservoir_performance_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`p`</span>, <span class="no">Sg</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Gas Saturation Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p1</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">

<span class="no">p2</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`GOR (SCF/STB)`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">reservoir_performance_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`p`</span>, <span class="no">GOR</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"GOR Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p2</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-5-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">

<span class="no">p3</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`RF_oil`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">reservoir_performance_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`p`</span>, <span class="no">RF_oil</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Oil Recovery Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p3</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-5-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">

<span class="no">p4</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`Liq_volume`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"CCE Liquid Volume Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p4</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-5-4.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">

<span class="no">p5</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span>  <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span>(<span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Igd"</span>, <span class="st">"Ifwd"</span>), <span class="kw">names_to</span> <span class="kw">=</span> <span class="st">"Drive Mechanism"</span>,
                      <span class="kw">values_to</span> <span class="kw">=</span> <span class="st">"Fraction"</span>, <span class="kw">values_drop_na</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">Fraction</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">`Drive Mechanism`</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Energy Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p5</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-5-5.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="example-3-rich-gas-condensate-reservoir-walsh1994a" class="section level2">
<h2 class="hasAnchor">
<a href="#example-3-rich-gas-condensate-reservoir-walsh1994a" class="anchor"></a><code>Example 3: Rich Gas Condensate Reservoir</code> <font size="2"> <span class="citation">(Walsh et al., 1994)</span> </font>
</h2>
<div id="part-i-reservoir-forecast-1" class="section level3">
<h3 class="hasAnchor">
<a href="#part-i-reservoir-forecast-1" class="anchor"></a><code>Part I: Reservoir Forecast</code>
</h3>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rmbal</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rrelperm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pracma</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)

<span class="no">p_pvt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5800</span>,    <span class="fl">5550</span>,   <span class="fl">5450</span>,   <span class="fl">5420</span>,   <span class="fl">5300</span>,   <span class="fl">4800</span>,   <span class="fl">4300</span>,   <span class="fl">3800</span>,   <span class="fl">3300</span>,   <span class="fl">2800</span>,   <span class="fl">2300</span>,
           <span class="fl">1800</span>,    <span class="fl">1300</span>,   <span class="fl">800</span>) <span class="co"># psia</span>

<span class="no">Bo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.382</span>,  <span class="fl">4.441</span>,  <span class="fl">4.468</span>,  <span class="fl">2.378</span>,  <span class="fl">2.366</span>,  <span class="fl">2.032</span>,  <span class="fl">1.828</span>,  <span class="fl">1.674</span>,  <span class="fl">1.554</span>,
        <span class="fl">1.448</span>,  <span class="fl">1.36</span>,   <span class="fl">1.279</span>,  <span class="fl">1.2</span>,    <span class="fl">1.131</span>) <span class="co"># RB/STB</span>

<span class="no">Rs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6042</span>,   <span class="fl">6042</span>,   <span class="fl">6042</span>,   <span class="fl">2795</span>,   <span class="fl">2750</span>,   <span class="fl">2128</span>,   <span class="fl">1730</span>,   <span class="fl">1422</span>,   <span class="fl">1177</span>,   <span class="fl">960</span>,    <span class="fl">776</span>,    <span class="fl">607</span>,
        <span class="fl">443</span>,    <span class="fl">293</span>) <span class="co">#SCF/STB</span>

<span class="no">Bg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.725</span>,  <span class="fl">0.735</span>,  <span class="fl">0.739</span>,  <span class="fl">0.74</span>,   <span class="fl">0.743</span>,  <span class="fl">0.758</span>,  <span class="fl">0.794</span>,  <span class="fl">0.854</span>,  <span class="fl">0.947</span>,
        <span class="fl">1.09</span>,   <span class="fl">1.313</span>,  <span class="fl">1.677</span>,  <span class="fl">2.316</span>,  <span class="fl">3.695</span>) / <span class="fl">1000</span> <span class="co"># RB/SCF</span>

<span class="no">Rv</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">165.5</span>,  <span class="fl">165.5</span>,  <span class="fl">165.5</span>,  <span class="fl">164.2</span>,  <span class="fl">156.6</span>,  <span class="fl">114</span>,    <span class="fl">89</span>, <span class="fl">65.2</span>,   <span class="fl">48.3</span>,   <span class="fl">35</span>, <span class="fl">25</span>,
        <span class="fl">19</span>, <span class="fl">15</span>, <span class="fl">13.5</span>) / <span class="fl">1e6</span> <span class="co"># STB/SCF</span>

<span class="no">cw</span> <span class="kw">&lt;-</span> <span class="fl">2e-6</span>

<span class="no">Bwi</span> <span class="kw">&lt;-</span> <span class="fl">1.0</span>

<span class="no">Bw</span> <span class="kw">&lt;-</span> <span class="no">Bwi</span> * <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">cw</span> * (<span class="no">p_pvt</span>[<span class="fl">1</span>] - <span class="no">p_pvt</span>))


<span class="no">muo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.0612</span>,    <span class="fl">0.062</span>,  <span class="fl">0.0587</span>, <span class="fl">0.135</span>,  <span class="fl">0.1338</span>, <span class="fl">0.1826</span>, <span class="fl">0.2354</span>, <span class="fl">0.3001</span>, <span class="fl">0.3764</span>,
         <span class="fl">0.4781</span>,    <span class="fl">0.6041</span>, <span class="fl">0.7746</span>, <span class="fl">1.0295</span>, <span class="fl">1.358</span>)  <span class="co"># cp</span>

<span class="no">muw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.25</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p_pvt</span>))

<span class="no">mug</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.0612</span>,    <span class="fl">0.062</span>,  <span class="fl">0.0587</span>, <span class="fl">0.0581</span>, <span class="fl">0.0554</span>, <span class="fl">0.0436</span>, <span class="fl">0.0368</span>, <span class="fl">0.0308</span>, <span class="fl">0.0261</span>,
         <span class="fl">0.0222</span>,    <span class="fl">0.0191</span>, <span class="fl">0.0166</span>, <span class="fl">0.0148</span>, <span class="fl">0.0135</span>) <span class="co"># cp</span>

<span class="no">pvt_table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="no">p_pvt</span>, <span class="kw">Bo</span> <span class="kw">=</span> <span class="no">Bo</span>, <span class="kw">Rs</span> <span class="kw">=</span> <span class="no">Rs</span>, <span class="kw">Rv</span> <span class="kw">=</span> <span class="no">Rv</span>, <span class="kw">Bg</span> <span class="kw">=</span> <span class="no">Bg</span>,
                               <span class="kw">Bw</span> <span class="kw">=</span> <span class="no">Bw</span>, <span class="kw">muo</span> <span class="kw">=</span> <span class="no">muo</span>, <span class="kw">mug</span> <span class="kw">=</span> <span class="no">mug</span>, <span class="kw">muw</span> <span class="kw">=</span> <span class="no">muw</span>)

<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5800</span>,    <span class="fl">5550</span>,   <span class="fl">5450</span>,   <span class="fl">5420</span>,   <span class="fl">5300</span>,   <span class="fl">4800</span>,   <span class="fl">4300</span>,   <span class="fl">3800</span>,   <span class="fl">3300</span>,   <span class="fl">2800</span>,   <span class="fl">2300</span>,
           <span class="fl">1800</span>,    <span class="fl">1300</span>,   <span class="fl">800</span>) <span class="co"># psia</span>

<span class="no">Gi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">wf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="co"># generating a set of pseudo relative permeability curves using </span>
<span class="co"># laboratory 'Kr' values</span>

<span class="no">sg_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.152</span>, <span class="fl">0.248</span>, <span class="fl">0.352</span>, <span class="fl">0.448</span>, <span class="fl">0.552</span>, <span class="fl">0.65</span>)

<span class="no">krg_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.09</span>, <span class="fl">0.18</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">1</span>)

<span class="no">kro_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0.6</span>, <span class="fl">0.35</span>, <span class="fl">0.13</span>, <span class="fl">0.04</span>, <span class="fl">0.01</span>, <span class="fl">0</span>)

<span class="no">swcrit_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.2</span>

<span class="no">sgcrit_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.05</span>

<span class="no">sorgr_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.15</span>

<span class="no">fun_kr</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">swcrit</span>, <span class="no">sgcrit</span>, <span class="no">sorg</span>, <span class="no">sg</span>, <span class="no">krg</span>, <span class="no">kro</span>) {

  <span class="no">kr_est</span> <span class="kw">&lt;-</span> <span class="kw pkg">Rrelperm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rrelperm/man/kr2p_gl.html">kr2p_gl</a></span>(<span class="kw">SWCON</span> <span class="kw">=</span> <span class="no">swcrit</span>, <span class="kw">SOIRG</span> <span class="kw">=</span> <span class="no">sorg</span>, <span class="kw">SORG</span> <span class="kw">=</span> <span class="no">sorg</span>,
                               <span class="kw">SGCON</span> <span class="kw">=</span> <span class="no">sgcrit</span>, <span class="kw">SGCRIT</span> <span class="kw">=</span> <span class="no">sgcrit</span>, <span class="kw">KRGCL</span> <span class="kw">=</span> <span class="fl">1</span>,
                               <span class="kw">KROGCG</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">NG</span> <span class="kw">=</span> <span class="no">x</span>[<span class="fl">1</span>], <span class="kw">NOG</span> <span class="kw">=</span> <span class="no">x</span>[<span class="fl">2</span>], <span class="kw">NP</span> <span class="kw">=</span> <span class="fl">101</span>)

   <span class="no">krg_est_sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">1</span>], <span class="kw">y</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">3</span>], <span class="kw">xout</span> <span class="kw">=</span> <span class="no">sg</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="fl">2</span>)$<span class="no">y</span>

   <span class="no">kro_est_sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">1</span>], <span class="kw">y</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">4</span>], <span class="kw">xout</span> <span class="kw">=</span> <span class="no">sg</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="fl">2</span>)$<span class="no">y</span>

   <span class="no">error</span> <span class="kw">&lt;-</span> (<span class="no">krg</span> - <span class="no">krg_est_sub</span>) ^ <span class="fl">2</span> + (<span class="no">kro</span> - <span class="no">kro_est_sub</span>) ^ <span class="fl">2</span>

   <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">error</span>)
}

<span class="no">par</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>)

<span class="no">opt_results</span> <span class="kw">&lt;-</span> <span class="kw pkg">minpack.lm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html">nls.lm</a></span>(<span class="kw">par</span> <span class="kw">=</span> <span class="no">par</span>, <span class="kw">fn</span> <span class="kw">=</span> <span class="no">fun_kr</span>, <span class="kw">swcrit</span> <span class="kw">=</span> <span class="no">swcrit_lab</span>,
                                  <span class="kw">sgcrit</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>, <span class="kw">sorg</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>, <span class="kw">sg</span> <span class="kw">=</span> <span class="no">sg_lab</span>,
                                  <span class="kw">krg</span> <span class="kw">=</span> <span class="no">krg_lab</span>, <span class="kw">kro</span> <span class="kw">=</span> <span class="no">kro_lab</span>,
                                  <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">10</span>))

<span class="no">sol</span> <span class="kw">&lt;-</span> <span class="no">opt_results</span>$<span class="no">par</span>

<span class="no">sol</span>
<span class="co">#&gt; [1] 3.157478 2.740570</span>

<span class="no">rel_perm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw pkg">Rrelperm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rrelperm/man/kr2p_gl.html">kr2p_gl</a></span>(<span class="kw">SWCON</span> <span class="kw">=</span> <span class="no">swcrit_lab</span>, <span class="kw">SOIRG</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>,
                                            <span class="kw">SORG</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>, <span class="kw">SGCON</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>,
                                            <span class="kw">SGCRIT</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>, <span class="kw">KRGCL</span> <span class="kw">=</span> <span class="fl">1</span>,
                                            <span class="kw">KROGCG</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">NG</span> <span class="kw">=</span> <span class="no">sol</span>[<span class="fl">1</span>], <span class="kw">NOG</span> <span class="kw">=</span> <span class="no">sol</span>[<span class="fl">2</span>],
                                            <span class="kw">NP</span> <span class="kw">=</span> <span class="fl">101</span>))

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rel_perm</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Sg"</span>, <span class="st">"Sl"</span>, <span class="st">"Krg"</span>, <span class="st">"Krog"</span>)

<span class="no">p_forecast</span> <span class="kw">&lt;-</span> <span class="no">p</span>

<span class="no">Gi_forecast</span> <span class="kw">&lt;-</span> <span class="no">Gi</span>

<span class="no">wf_forecast</span> <span class="kw">&lt;-</span> <span class="no">wf</span>

<span class="no">time_lst_forecast</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_time.html">mbal_time</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p_forecast</span>)), <span class="st">"year"</span>)

<span class="no">forecast_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_forecast_param_gas.html">mbal_forecast_param_gas</a></span>(<span class="kw">input_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>, <span class="kw">output_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>,
                                        <span class="kw">G</span> <span class="kw">=</span> <span class="fl">1e6</span>, <span class="kw">phi</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">swi</span> <span class="kw">=</span> <span class="fl">0.2</span>,
                                        <span class="kw">pd</span> <span class="kw">=</span> <span class="fl">5430</span>, <span class="kw">p</span> <span class="kw">=</span> <span class="no">p_forecast</span>, <span class="kw">pvt</span> <span class="kw">=</span> <span class="no">pvt_table</span>,
                                        <span class="kw">M</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">cf</span> <span class="kw">=</span> <span class="fl">2e-6</span>, <span class="kw">wf</span> <span class="kw">=</span> <span class="no">wf_forecast</span>,
                                        <span class="kw">rel_perm</span> <span class="kw">=</span> <span class="no">rel_perm</span>)

<span class="no">forecast_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_forecast_gas.html">mbal_forecast_gas</a></span>(<span class="no">forecast_lst</span>, <span class="no">time_lst_forecast</span>)

<span class="no">forecast_results</span>
<span class="co">#&gt;    P (psia)         SOg       SGg SWg         SOT       SGT SWT GOR (SCF/STB)</span>
<span class="co">#&gt; 1      5800 0.000000000 0.8000000 0.2 0.000000000 0.8000000 0.2      6042.296</span>
<span class="co">#&gt; 2      5550 0.000000000 0.8000000 0.2 0.000000000 0.8000000 0.2      6042.296</span>
<span class="co">#&gt; 3      5450 0.000000000 0.8000000 0.2 0.000000000 0.8000000 0.2      6042.296</span>
<span class="co">#&gt; 4      5420 0.005152288 0.7948477 0.2 0.005152288 0.7948477 0.2      6090.134</span>
<span class="co">#&gt; 5      5300 0.038538384 0.7614616 0.2 0.038538384 0.7614616 0.2      6385.696</span>
<span class="co">#&gt; 6      4800 0.143496208 0.6565038 0.2 0.143496208 0.6565038 0.2      8771.930</span>
<span class="co">#&gt; 7      4300 0.168505366 0.6314946 0.2 0.168505366 0.6314946 0.2     11235.330</span>
<span class="co">#&gt; 8      3800 0.183977117 0.6160229 0.2 0.183977117 0.6160229 0.2     15332.031</span>
<span class="co">#&gt; 9      3300 0.187431883 0.6125681 0.2 0.187431883 0.6125681 0.2     20693.172</span>
<span class="co">#&gt; 10     2800 0.185132689 0.6148673 0.2 0.185132689 0.6148673 0.2     28556.781</span>
<span class="co">#&gt; 11     2300 0.180121470 0.6198785 0.2 0.180121470 0.6198785 0.2     39984.461</span>
<span class="co">#&gt; 12     1800 0.172066360 0.6279336 0.2 0.172066360 0.6279336 0.2     52620.567</span>
<span class="co">#&gt; 13     1300 0.162517114 0.6374829 0.2 0.162517114 0.6374829 0.2     66662.406</span>
<span class="co">#&gt; 14      800 0.153317651 0.6466823 0.2 0.153317651 0.6466823 0.2     74073.272</span>
<span class="co">#&gt;        RF_oil     RF_gas Liq_volume       Igd Inwd        Ifwd Iawd Itot</span>
<span class="co">#&gt; 1  0.00000000 0.00000000 0.00000000        NA   NA          NA   NA   NA</span>
<span class="co">#&gt; 2  0.01434527 0.01434527 0.00000000 0.9484271    0 0.051572874    0    1</span>
<span class="co">#&gt; 3  0.01997469 0.01997469 0.00000000 0.9484263    0 0.051573690    0    1</span>
<span class="co">#&gt; 4  0.02236209 0.02237150 0.00771331 0.9501195    0 0.049880460    0    1</span>
<span class="co">#&gt; 5  0.03198528 0.03230067 0.04944218 0.9549330    0 0.045066956    0    1</span>
<span class="co">#&gt; 6  0.07264828 0.08203996 0.17567452 0.9658304    0 0.034169615    0    1</span>
<span class="co">#&gt; 7  0.10763210 0.13908121 0.19793410 0.9712101    0 0.028789884    0    1</span>
<span class="co">#&gt; 8  0.14065622 0.20995733 0.20452906 0.9763715    0 0.023628476    0    1</span>
<span class="co">#&gt; 9  0.16846524 0.29102297 0.19279839 0.9807127    0 0.019287285    0    1</span>
<span class="co">#&gt; 10 0.19178099 0.38362298 0.17088678 0.9846668    0 0.015333241    0    1</span>
<span class="co">#&gt; 11 0.21013894 0.48485147 0.14308242 0.9881815    0 0.011818547    0    1</span>
<span class="co">#&gt; 12 0.22436893 0.59186666 0.11048587 0.9912889    0 0.008711064    0    1</span>
<span class="co">#&gt; 13 0.23579468 0.70041590 0.07761736 0.9939804    0 0.006019611    0    1</span>
<span class="co">#&gt; 14 0.24476201 0.80834308 0.04661722 0.9963577    0 0.003642279    0    1</span>

<span class="no">reservoir_performance_table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="no">p</span>)

<span class="no">reservoir_performance_table</span>$<span class="no">`RF_oil`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,    <span class="fl">1.3</span>,    <span class="fl">1.9</span>,    <span class="fl">2.1</span>,    <span class="fl">2.6</span>,    <span class="fl">7</span>,  <span class="fl">10.1</span>,   <span class="fl">13.3</span>,
                                          <span class="fl">16.2</span>, <span class="fl">18.4</span>,   <span class="fl">20.2</span>,   <span class="fl">21.6</span>,   <span class="fl">22.8</span>,   <span class="fl">23.7</span>) / <span class="fl">100</span>

<span class="no">reservoir_performance_table</span>$<span class="no">`Sg`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>,  <span class="fl">100</span>,    <span class="fl">100</span>,    <span class="fl">99.2</span>,   <span class="fl">95</span>, <span class="fl">81.8</span>,   <span class="fl">78.7</span>,   <span class="fl">76.7</span>,   <span class="fl">76.3</span>,
                                      <span class="fl">76.6</span>, <span class="fl">77.2</span>,   <span class="fl">78.3</span>,   <span class="fl">79.5</span>,   <span class="fl">80.6</span>) * <span class="fl">0.8</span> / <span class="fl">100</span>


<span class="no">reservoir_performance_table</span>$<span class="no">`GOR`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6.04</span>,    <span class="fl">6.04</span>,   <span class="fl">6.04</span>,   <span class="fl">6.09</span>,   <span class="fl">6.39</span>,   <span class="fl">8.77</span>,   <span class="fl">11.22</span>,
                                       <span class="fl">15.29</span>,   <span class="fl">20.62</span>, <span class="fl">28.45</span>, <span class="fl">39.82</span>, <span class="fl">52.42</span>, <span class="fl">66.48</span>,
                                       <span class="fl">73.99</span>) * <span class="fl">1000</span> <span class="co"># SCF/STB</span>


<span class="no">p1</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">SGg</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">reservoir_performance_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`p`</span>, <span class="no">Sg</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Gas Saturation Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p1</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><html><body><pre class="r">

<span class="no">p2</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`GOR (SCF/STB)`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">reservoir_performance_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`p`</span>, <span class="no">GOR</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"GOR Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p2</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-6-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><html><body><pre class="r">

<span class="no">p3</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`RF_oil`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">reservoir_performance_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`p`</span>, <span class="no">RF_oil</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Oil Recovery Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p3</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-6-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><html><body><pre class="r">

<span class="no">p4</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`Liq_volume`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"CCE Liquid Volume Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p4</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-6-4.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><html><body><pre class="r">

<span class="no">p5</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span>  <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span>(<span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Igd"</span>, <span class="st">"Ifwd"</span>), <span class="kw">names_to</span> <span class="kw">=</span> <span class="st">"Drive Mechanism"</span>,
                      <span class="kw">values_to</span> <span class="kw">=</span> <span class="st">"Fraction"</span>, <span class="kw">values_drop_na</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">Fraction</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">`Drive Mechanism`</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Energy Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p5</span></pre></body></html></div>
<p><img src="GasCondensate_files/figure-html/unnamed-chunk-6-5.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a><code>References</code>
</h2>
<div id="refs" class="references">
<div id="ref-Walsh1994a">
<p>Walsh, M. P., Ansah, J., &amp; Raghavan, R. (1994). New, generalized material balance as an equation of a straight line: Part 1- Applications to undersaturated, volumetric reservoirs. <em>Proceedings of the Permian Basin Oil &amp; Gas Recovery Conference</em>, 549â€“564. <a href="https://doi.org/10.2118/27684-MS">https://doi.org/10.2118/27684-MS</a></p>
</div>
<div id="ref-Walsh2003">
<p>Walsh, M. P., &amp; Lake, L. W. (2003). <em>A Generalized Approach to Primary Hydrocarbon Recovery</em> (1st ed., p. 652; M. P. Walsh &amp; L. W. Lake, Eds.). Retrieved from <a href="https://www.elsevier.com/books/a-generalized-approach-to-primary-hydrocarbon-recovery-of-petroleum-exploration-and-production/walsh/978-0-444-50683-2">https://www.elsevier.com/books/a-generalized-approach-to-primary-hydrocarbon-recovery-of-petroleum-exploration-and-production/walsh/978-0-444-50683-2</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://susaenergy.com/">Farshad Tabasinejad</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
