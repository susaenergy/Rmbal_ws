<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Material Balance - Volatile Oil Reservoirs â€¢ Rmbal</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Material Balance - Volatile Oil Reservoirs">
<meta property="og:description" content="Rmbal">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rmbal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BlackOil.html">Material Balance - Black Oil Reservoirs</a>
    </li>
    <li>
      <a href="../articles/DryWetGas.html">Material Balance - Dry and Wet Gas Reservoirs</a>
    </li>
    <li>
      <a href="../articles/GasCondensate.html">Material Balance - Gas Condensate Reservoirs</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Rmbal Package</a>
    </li>
    <li>
      <a href="../articles/VolatileOil.html">Material Balance - Volatile Oil Reservoirs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Material Balance - Volatile Oil Reservoirs</h1>
            
      
      
      <div class="hidden name"><code>VolatileOil.Rmd</code></div>

    </div>

    
    
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a><code>Examples</code>
</h2>
<div id="example-1-undersaturated-volatile-oil-reservoir-walsh1995" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-undersaturated-volatile-oil-reservoir-walsh1995" class="anchor"></a><code>Example 1: Undersaturated Volatile Oil Reservoir</code> <font size="2"> <span class="citation">(Walsh, 1995)</span> </font>
</h3>
<div id="part-i-history-match" class="section level4">
<h4 class="hasAnchor">
<a href="#part-i-history-match" class="anchor"></a><code>Part I: History Match</code>
</h4>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rmbal</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rrelperm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pracma</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">minpack.lm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'magrittr'</span>
<span class="co">#&gt; The following objects are masked from 'package:pracma':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     and, mod, or</span>

<span class="no">p_pvt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5070</span>, <span class="fl">4998</span>, <span class="fl">4798</span>, <span class="fl">4698</span>, <span class="fl">4658</span>, <span class="fl">4598</span>, <span class="fl">4398</span>, <span class="fl">4198</span>, <span class="fl">3998</span>, <span class="fl">3798</span>, <span class="fl">3598</span>, <span class="fl">3398</span>,
           <span class="fl">3198</span>, <span class="fl">2998</span>, <span class="fl">2798</span>, <span class="fl">2598</span>, <span class="fl">2398</span>, <span class="fl">2198</span>, <span class="fl">1998</span>, <span class="fl">1798</span>, <span class="fl">1598</span>, <span class="fl">1398</span>, <span class="fl">1198</span>, <span class="fl">998</span>, <span class="fl">798</span>, <span class="fl">598</span>)

<span class="no">Bo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.704</span>, <span class="fl">2.713</span>, <span class="fl">2.740</span>, <span class="fl">2.754</span>, <span class="fl">2.707</span>, <span class="fl">2.631</span>, <span class="fl">2.338</span>, <span class="fl">2.204</span>, <span class="fl">2.093</span>, <span class="fl">1.991</span>, <span class="fl">1.905</span>,
        <span class="fl">1.828</span>, <span class="fl">1.758</span>, <span class="fl">1.686</span>, <span class="fl">1.632</span>, <span class="fl">1.580</span>, <span class="fl">1.534</span>, <span class="fl">1.49</span>, <span class="fl">1.45</span>, <span class="fl">1.413</span>, <span class="fl">1.367</span>, <span class="fl">1.333</span>, <span class="fl">1.305</span>,
        <span class="fl">1.272</span>, <span class="fl">1.239</span>, <span class="fl">1.205</span>)  <span class="co"># RB/STB</span>

<span class="no">Rv</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">343</span>, <span class="fl">343</span>, <span class="fl">343</span>, <span class="fl">343</span>, <span class="fl">116</span>, <span class="fl">111</span>, <span class="fl">106</span>, <span class="fl">94</span>, <span class="fl">84</span>, <span class="fl">74</span>, <span class="fl">66</span>, <span class="fl">60</span>, <span class="fl">54</span>, <span class="fl">49</span>, <span class="fl">44</span>, <span class="fl">39</span>, <span class="fl">36</span>,
        <span class="fl">33</span>, <span class="fl">30</span>, <span class="fl">28</span>, <span class="fl">26</span>, <span class="fl">25</span>, <span class="fl">24.1</span>, <span class="fl">23.9</span>, <span class="fl">24.4</span>, <span class="fl">26.4</span>) / <span class="fl">1e6</span>  <span class="co"># STB/SCF</span>

<span class="no">Rs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2909</span>, <span class="fl">2909</span>, <span class="fl">2909</span>, <span class="fl">2909</span>, <span class="fl">2834</span>, <span class="fl">2711</span>, <span class="fl">2247</span>, <span class="fl">2019</span>, <span class="fl">1828</span>, <span class="fl">1651</span>, <span class="fl">1500</span>, <span class="fl">1364</span>, <span class="fl">1237</span>,
        <span class="fl">1111</span>, <span class="fl">1013</span>, <span class="fl">918</span>, <span class="fl">833</span>, <span class="fl">752</span>, <span class="fl">677</span>, <span class="fl">608</span>, <span class="fl">524</span>, <span class="fl">461</span>, <span class="fl">406</span>, <span class="fl">344</span>, <span class="fl">283</span>, <span class="fl">212</span>)  <span class="co"># SCF/STB</span>

<span class="no">Bg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">9.27472e-04</span>, <span class="fl">9.30559e-04</span>, <span class="fl">9.39820e-04</span>, <span class="fl">9.44622e-04</span>, <span class="fl">0.83</span>, <span class="fl">0.835</span>, <span class="fl">0.853</span>,
        <span class="fl">0.874</span>, <span class="fl">0.901</span>, <span class="fl">0.933</span>, <span class="fl">0.97</span>, <span class="fl">1.015</span>, <span class="fl">1.066</span>, <span class="fl">1.125</span>, <span class="fl">1.196</span>, <span class="fl">1.281</span>, <span class="fl">1.38</span>, <span class="fl">1.498</span>,
        <span class="fl">1.642</span>, <span class="fl">1.819</span>, <span class="fl">2.035</span>, <span class="fl">2.315</span>, <span class="fl">2.689</span>, <span class="fl">3.19</span>, <span class="fl">3.911</span>, <span class="fl">5.034</span>) / <span class="fl">1000</span>  <span class="co"># RB/SCF</span>

<span class="no">cw</span> <span class="kw">&lt;-</span> <span class="fl">3e-6</span>

<span class="no">Bwi</span> <span class="kw">&lt;-</span> <span class="fl">1.05</span>

<span class="no">Bw</span> <span class="kw">&lt;-</span> <span class="no">Bwi</span> * <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">cw</span> * (<span class="no">p_pvt</span>[<span class="fl">1</span>] - <span class="no">p_pvt</span>))

<span class="no">muo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">742</span>, <span class="fl">735</span>, <span class="fl">716</span>, <span class="fl">706</span>, <span class="fl">718</span>, <span class="fl">739</span>, <span class="fl">847</span>, <span class="fl">906</span>, <span class="fl">968</span>, <span class="fl">1028</span>, <span class="fl">1104</span>, <span class="fl">1177</span>, <span class="fl">1242</span>, <span class="fl">1325</span>,
         <span class="fl">1409</span>, <span class="fl">1501</span>, <span class="fl">1598</span>, <span class="fl">1697</span>, <span class="fl">1817</span>, <span class="fl">1940</span>, <span class="fl">2064</span>, <span class="fl">2223</span>, <span class="fl">2438</span>, <span class="fl">2629</span>, <span class="fl">2882</span>, <span class="fl">3193</span>) / <span class="fl">10000</span>

<span class="no">mug</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">742</span>, <span class="fl">735</span>, <span class="fl">716</span>, <span class="fl">706</span>, <span class="fl">375</span>, <span class="fl">367</span>, <span class="fl">350</span>, <span class="fl">327</span>, <span class="fl">306</span>, <span class="fl">288</span>, <span class="fl">271</span>, <span class="fl">255</span>, <span class="fl">240</span>, <span class="fl">227</span>, <span class="fl">214</span>,
         <span class="fl">203</span>, <span class="fl">193</span>, <span class="fl">184</span>, <span class="fl">175</span>, <span class="fl">168</span>, <span class="fl">161</span>, <span class="fl">155</span>, <span class="fl">150</span>, <span class="fl">146</span>, <span class="fl">142</span>, <span class="fl">138</span>) / <span class="fl">10000</span>

<span class="no">muw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.25</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p_pvt</span>))

<span class="no">liq_vol</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1000</span>, <span class="fl">1000</span>, <span class="fl">1000</span>, <span class="fl">1000</span>, <span class="fl">967</span>, <span class="fl">847</span>, <span class="fl">747</span>, <span class="fl">683</span>, <span class="fl">630</span>, <span class="fl">584</span>, <span class="fl">544</span>, <span class="fl">508</span>, <span class="fl">471</span>, <span class="fl">433</span>,
             <span class="fl">402</span>, <span class="fl">368</span>, <span class="fl">336</span>, <span class="fl">305</span>, <span class="fl">271</span>, <span class="fl">239</span>, <span class="fl">209</span>, <span class="fl">177</span>, <span class="fl">146</span>, <span class="fl">117</span>, <span class="fl">89</span>, <span class="fl">63</span>) / <span class="fl">1000</span>

<span class="no">pvt_table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="no">p_pvt</span>, <span class="kw">Bo</span> <span class="kw">=</span> <span class="no">Bo</span>, <span class="kw">Rs</span> <span class="kw">=</span> <span class="no">Rs</span>, <span class="kw">Rv</span> <span class="kw">=</span> <span class="no">Rv</span>, <span class="kw">Bg</span> <span class="kw">=</span> <span class="no">Bg</span>,
                               <span class="kw">Bw</span> <span class="kw">=</span> <span class="no">Bw</span>, <span class="kw">muo</span> <span class="kw">=</span> <span class="no">muo</span>, <span class="kw">mug</span> <span class="kw">=</span> <span class="no">mug</span>, <span class="kw">muw</span> <span class="kw">=</span> <span class="no">muw</span>)

<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5070</span>, <span class="fl">4998</span>, <span class="fl">4798</span>, <span class="fl">4698</span>, <span class="fl">4658</span>, <span class="fl">4598</span>, <span class="fl">4398</span>, <span class="fl">4198</span>, <span class="fl">3998</span>, <span class="fl">3798</span>, <span class="fl">3598</span>, <span class="fl">3398</span>,
           <span class="fl">3198</span>, <span class="fl">2998</span>, <span class="fl">2798</span>, <span class="fl">2598</span>, <span class="fl">2398</span>, <span class="fl">2198</span>, <span class="fl">1998</span>, <span class="fl">1798</span>, <span class="fl">1598</span>, <span class="fl">1398</span>, <span class="fl">1198</span>, <span class="fl">998</span>, <span class="fl">798</span>)

<span class="no">We</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">Np</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">36</span>, <span class="fl">130</span>, <span class="fl">184</span>, <span class="fl">227</span>, <span class="fl">302</span>, <span class="fl">582</span>, <span class="fl">808</span>, <span class="fl">1022</span>, <span class="fl">1227</span>, <span class="fl">1388</span>, <span class="fl">1528</span>, <span class="fl">1646</span>, <span class="fl">1764</span>, <span class="fl">1861</span>,
        <span class="fl">1947</span>, <span class="fl">2022</span>, <span class="fl">2097</span>, <span class="fl">2151</span>, <span class="fl">2215</span>, <span class="fl">2269</span>, <span class="fl">2323</span>, <span class="fl">2366</span>, <span class="fl">2420</span>, <span class="fl">2463</span>) * <span class="fl">1e6</span> / <span class="fl">1000</span>

<span class="no">Rp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">2909.000</span>, <span class="fl">2909.000</span>, <span class="fl">2909.000</span>, <span class="fl">2894.273</span>, <span class="fl">2887.417</span>, <span class="fl">2847.079</span>, <span class="fl">2928.218</span>, <span class="fl">3072.407</span>,
        <span class="fl">3286.064</span>, <span class="fl">3578.530</span>, <span class="fl">3918.848</span>, <span class="fl">4290.401</span>, <span class="fl">4661.565</span>, <span class="fl">5053.735</span>, <span class="fl">5470.981</span>, <span class="fl">5889.713</span>,
        <span class="fl">6294.230</span>, <span class="fl">6760.576</span>, <span class="fl">7172.009</span>, <span class="fl">7640.811</span>, <span class="fl">8059.836</span>, <span class="fl">8499.155</span>, <span class="fl">8900.413</span>, <span class="fl">9329.679</span>)

<span class="no">Wp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">Wi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">Gi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">wf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">mbal_optim_oil_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_optim_param_oil.html">mbal_optim_param_oil</a></span>(<span class="kw">input_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>, <span class="kw">output_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>,
                                          <span class="kw">unknown_param</span> <span class="kw">=</span> <span class="st">"N"</span>, <span class="kw">aquifer_model</span> <span class="kw">=</span> <span class="kw">NULL</span>,
                                          <span class="kw">m</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">phi</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">swi</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">Np</span> <span class="kw">=</span> <span class="no">Np</span>,
                                          <span class="kw">Rp</span> <span class="kw">=</span> <span class="no">Rp</span>, <span class="kw">Wp</span> <span class="kw">=</span> <span class="no">Wp</span>, <span class="kw">Gi</span> <span class="kw">=</span> <span class="no">Gi</span>, <span class="kw">Wi</span> <span class="kw">=</span> <span class="no">Wi</span>, <span class="kw">We</span> <span class="kw">=</span> <span class="no">We</span>,
                                          <span class="kw">pb</span> <span class="kw">=</span> <span class="fl">4698</span>, <span class="kw">p</span> <span class="kw">=</span> <span class="no">p</span>, <span class="kw">pvt</span> <span class="kw">=</span> <span class="no">pvt_table</span>, <span class="kw">cf</span> <span class="kw">=</span> <span class="fl">2e-6</span>,
                                          <span class="kw">wf</span> <span class="kw">=</span> <span class="no">wf</span>, <span class="kw">sorg</span> <span class="kw">=</span> <span class="fl">0.15</span>, <span class="kw">sorw</span> <span class="kw">=</span> <span class="fl">0.0</span>)

<span class="no">time_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_time.html">mbal_time</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>)), <span class="st">"year"</span>)

<span class="co"># a number of plots will be automatically generated for quality check</span>

<span class="no">optim_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_optim_oil.html">mbal_optim_oil</a></span>(<span class="no">mbal_optim_oil_lst</span>, <span class="no">time_lst</span>)</pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"><img src="VolatileOil_files/figure-html/unnamed-chunk-2-2.png" width="576" style="display: block; margin: auto;"><img src="VolatileOil_files/figure-html/unnamed-chunk-2-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="no">optim_results</span>)
<span class="co">#&gt; List of 18</span>
<span class="co">#&gt;  $ input_unit : chr "Field"</span>
<span class="co">#&gt;  $ output_unit: chr "Field"</span>
<span class="co">#&gt;  $ N          : num 10179044</span>
<span class="co">#&gt;  $ m          : num 0</span>
<span class="co">#&gt;  $ phi        : num 0.1</span>
<span class="co">#&gt;  $ swi        : num 0.2</span>
<span class="co">#&gt;  $ pb         : num 4698</span>
<span class="co">#&gt;  $ p          : num [1:25] 5070 4998 4798 4698 4658 ...</span>
<span class="co">#&gt;  $ cf         : num [1:25] 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 ...</span>
<span class="co">#&gt;  $ pvt        :'data.frame': 26 obs. of  9 variables:</span>
<span class="co">#&gt;   ..$ p  : num [1:26] 5070 4998 4798 4698 4658 ...</span>
<span class="co">#&gt;   ..$ Bo : num [1:26] 2.7 2.71 2.74 2.75 2.71 ...</span>
<span class="co">#&gt;   ..$ Rs : num [1:26] 2909 2909 2909 2909 2834 ...</span>
<span class="co">#&gt;   ..$ Rv : num [1:26] 0.000343 0.000343 0.000343 0.000343 0.000116 0.000111 0.000106 0.000094 0.000084 0.000074 ...</span>
<span class="co">#&gt;   ..$ Bg : num [1:26] 9.27e-07 9.31e-07 9.40e-07 9.45e-07 8.30e-04 ...</span>
<span class="co">#&gt;   ..$ Bw : num [1:26] 1.05 1.05 1.05 1.05 1.05 ...</span>
<span class="co">#&gt;   ..$ muo: num [1:26] 0.0742 0.0735 0.0716 0.0706 0.0718 ...</span>
<span class="co">#&gt;   ..$ mug: num [1:26] 0.0742 0.0735 0.0716 0.0706 0.0375 0.0367 0.035 0.0327 0.0306 0.0288 ...</span>
<span class="co">#&gt;   ..$ muw: num [1:26] 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 ...</span>
<span class="co">#&gt;  $ prod       :'data.frame': 25 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ Np: num [1:25] 0 36000 130000 184000 227000 ...</span>
<span class="co">#&gt;   ..$ Rp: num [1:25] 2909 2909 2909 2909 2894 ...</span>
<span class="co">#&gt;   ..$ Wp: num [1:25] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ inj        :'data.frame': 25 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ Gi: num [1:25] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ Wi: num [1:25] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ We         : num [1:25] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ aquifer    :List of 3</span>
<span class="co">#&gt;   ..$ input_unit : chr "Field"</span>
<span class="co">#&gt;   ..$ output_unit: chr "Field"</span>
<span class="co">#&gt;   ..$ We         : num [1:25] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "NoA" "aquifer"</span>
<span class="co">#&gt;  $ wf         : num [1:25] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ sorw       : num 0</span>
<span class="co">#&gt;  $ sorg       : num 0.15</span>
<span class="co">#&gt;  $ p_est      : num [1:25] 5070 4998 4822 4722 4659 ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "volumetric_oil" "mbal_oil"</span></pre></body></html></div>
</div>
<div id="part-ii-reservoir-performance" class="section level4">
<h4 class="hasAnchor">
<a href="#part-ii-reservoir-performance" class="anchor"></a><code>Part II: Reservoir Performance</code>
</h4>
<div class="sourceCode" id="cb3"><html><body><pre class="r">
<span class="no">mbal_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_perform_oil.html">mbal_perform_oil</a></span>(<span class="no">optim_results</span>, <span class="no">time_lst</span>)

<span class="no">mbal_results</span>
<span class="co">#&gt;    P (psia) Eo (bbl/STB) Eg (bbl/SCF) Ew (bbl/STB) Ef (bbl/bbl) Eowf (bbl/STB)</span>
<span class="co">#&gt; 1      5070   0.00000000 0.000000e+00 0.0000000000     0.000000    0.000000000</span>
<span class="co">#&gt; 2      4998   0.00900000 3.087000e-09 0.0002268245     0.000144    0.009632752</span>
<span class="co">#&gt; 3      4798   0.03600000 1.234800e-08 0.0008571497     0.000544    0.038390561</span>
<span class="co">#&gt; 4      4698   0.05000000 1.715000e-08 0.0011724541     0.000744    0.053269557</span>
<span class="co">#&gt; 5      4658   0.06065178 9.490492e-04 0.0012986024     0.000824    0.064272948</span>
<span class="co">#&gt; 6      4598   0.08078216 9.559716e-04 0.0014878532     0.000944    0.084930779</span>
<span class="co">#&gt; 7      4398   0.15987871 9.831409e-04 0.0021189352     0.001344    0.165785617</span>
<span class="co">#&gt; 8      4198   0.23248964 1.008110e-03 0.0027503959     0.001744    0.240155090</span>
<span class="co">#&gt; 9      3998   0.31513867 1.036533e-03 0.0033822357     0.002144    0.324562909</span>
<span class="co">#&gt; 10     3798   0.41292681 1.070159e-03 0.0040144547     0.002544    0.424110074</span>
<span class="co">#&gt; 11     3598   0.52128461 1.107419e-03 0.0046470531     0.002944    0.534227143</span>
<span class="co">#&gt; 12     3398   0.64739396 1.150783e-03 0.0052800312     0.003344    0.662096016</span>
<span class="co">#&gt; 13     3198   0.79384378 1.201136e-03 0.0059133893     0.003744    0.810305597</span>
<span class="co">#&gt; 14     2998   0.96411435 1.259675e-03 0.0065471274     0.004144    0.982336174</span>
<span class="co">#&gt; 15     2798   1.15890388 1.326652e-03 0.0071812459     0.004544    1.178885954</span>
<span class="co">#&gt; 16     2598   1.39393260 1.407462e-03 0.0078157450     0.004944    1.415675174</span>
<span class="co">#&gt; 17     2398   1.66525871 1.500751e-03 0.0084506249     0.005344    1.688762027</span>
<span class="co">#&gt; 18     2198   1.99065298 1.612626e-03 0.0090858858     0.005744    2.015917278</span>
<span class="co">#&gt; 19     1998   2.38781731 1.749177e-03 0.0097215280     0.006144    2.414842842</span>
<span class="co">#&gt; 20     1798   2.87439390 1.916468e-03 0.0103575517     0.006544    2.903180912</span>
<span class="co">#&gt; 21     1598   3.49757356 2.130698e-03 0.0109939571     0.006944    3.528122294</span>
<span class="co">#&gt; 22     1398   4.27966431 2.399578e-03 0.0116307445     0.007344    4.311975010</span>
<span class="co">#&gt; 23     1198   5.31857518 2.756755e-03 0.0122679141     0.007744    5.352648105</span>
<span class="co">#&gt; 24      998   6.73955521 3.245262e-03 0.0129054661     0.008144    6.775390588</span>
<span class="co">#&gt; 25      798   8.79675730 3.952480e-03 0.0135434007     0.008544    8.834355395</span>
<span class="co">#&gt;    Egwf (bbl/SCF)    Et (bbl)    F (bbl) We Igd       Isd Inwd        Ifwd Iawd</span>
<span class="co">#&gt; 1    0.000000e+00        0.00        0.0  0  NA        NA   NA          NA   NA</span>
<span class="co">#&gt; 2    3.304034e-09    98052.21    97668.0  0   0 0.9343125    0 0.065687540    0</span>
<span class="co">#&gt; 3    1.316796e-08   390779.22   356200.0  0   0 0.9377305    0 0.062269502    0</span>
<span class="co">#&gt; 4    1.827146e-08   542233.18   506736.0  0   0 0.9386224    0 0.061377592    0</span>
<span class="co">#&gt; 5    9.490504e-04   654237.18   625006.2  0   0 0.9436595    0 0.056340540    0</span>
<span class="co">#&gt; 6    9.559730e-04   864514.16   835941.8  0   0 0.9511530    0 0.048847003    0</span>
<span class="co">#&gt; 7    9.831429e-04  1687539.13  1638149.6  0   0 0.9643702    0 0.035629814    0</span>
<span class="co">#&gt; 8    1.008112e-03  2444549.29  2385463.6  0   0 0.9680812    0 0.031918753    0</span>
<span class="co">#&gt; 9    1.036536e-03  3303740.22  3228637.4  0   0 0.9709633    0 0.029036699    0</span>
<span class="co">#&gt; 10   1.070163e-03  4317035.22  4238553.9  0   0 0.9736312    0 0.026368777    0</span>
<span class="co">#&gt; 11   1.107423e-03  5437921.74  5347490.3  0   0 0.9757733    0 0.024226656    0</span>
<span class="co">#&gt; 12   1.150788e-03  6739504.66  6642399.0  0   0 0.9777947    0 0.022205321    0</span>
<span class="co">#&gt; 13   1.201141e-03  8248136.54  8123499.0  0   0 0.9796844    0 0.020315565    0</span>
<span class="co">#&gt; 14   1.259682e-03  9999243.40  9878649.0  0   0 0.9814505    0 0.018549478    0</span>
<span class="co">#&gt; 15   1.326659e-03 11999932.31 11885236.6  0   0 0.9830500    0 0.016949964    0</span>
<span class="co">#&gt; 16   1.407470e-03 14410220.26 14287009.0  0   0 0.9846416    0 0.015358446    0</span>
<span class="co">#&gt; 17   1.500759e-03 17189983.43 17065907.5  0   0 0.9860825    0 0.013917481    0</span>
<span class="co">#&gt; 18   1.612635e-03 20520111.21 20391408.7  0   0 0.9874676    0 0.012532409    0</span>
<span class="co">#&gt; 19   1.749186e-03 24580792.18 24470200.4  0   0 0.9888086    0 0.011191425    0</span>
<span class="co">#&gt; 20   1.916478e-03 29551607.01 29449581.2  0   0 0.9900843    0 0.009915679    0</span>
<span class="co">#&gt; 21   2.130709e-03 35912913.01 35835017.5  0   0 0.9913414    0 0.008658638    0</span>
<span class="co">#&gt; 22   2.399589e-03 43891784.50 43842502.2  0   0 0.9925068    0 0.007493249    0</span>
<span class="co">#&gt; 23   2.756767e-03 54484841.99 54478300.6  0   0 0.9936344    0 0.006365619    0</span>
<span class="co">#&gt; 24   3.245274e-03 68967000.71 69044893.8  0   0 0.9947109    0 0.005289050    0</span>
<span class="co">#&gt; 25   3.952493e-03 89925294.62 90124076.0  0   0 0.9957441    0 0.004255895    0</span>
<span class="co">#&gt;    Itot     RF_oil     RF_gas       SOo        SGo SWo       SOT           SGT</span>
<span class="co">#&gt; 1    NA 0.00000000 0.00000000 0.8000000 0.00000000 0.2 0.8000000 -5.551115e-17</span>
<span class="co">#&gt; 2     1 0.00355059 0.00355059 0.8000000 0.00000000 0.2 0.8000000 -5.551115e-17</span>
<span class="co">#&gt; 3     1 0.01401115 0.01401115 0.8000000 0.00000000 0.2 0.8000000 -5.551115e-17</span>
<span class="co">#&gt; 4     1 0.01934261 0.01934261 0.8000000 0.00000000 0.2 0.8000000 -5.551115e-17</span>
<span class="co">#&gt; 5     1 0.02334370 0.02322552 0.7726982 0.02730184 0.2 0.7726982  2.730184e-02</span>
<span class="co">#&gt; 6     1 0.03068287 0.03045522 0.7312697 0.06873030 0.2 0.7312697  6.873030e-02</span>
<span class="co">#&gt; 7     1 0.05890013 0.05764639 0.5916258 0.20837417 0.2 0.5916258  2.083742e-01</span>
<span class="co">#&gt; 8     1 0.08134490 0.08188230 0.5382687 0.26173128 0.2 0.5382687  2.617313e-01</span>
<span class="co">#&gt; 9     1 0.10273786 0.10850894 0.4981607 0.30183932 0.2 0.4981607  3.018393e-01</span>
<span class="co">#&gt; 10    1 0.12277373 0.13868763 0.4651739 0.33482608 0.2 0.4651739  3.348261e-01</span>
<span class="co">#&gt; 11    1 0.13866454 0.17057931 0.4401078 0.35989223 0.2 0.4401078  3.598922e-01</span>
<span class="co">#&gt; 12    1 0.15230683 0.20517955 0.4184090 0.38159099 0.2 0.4184090  3.815910e-01</span>
<span class="co">#&gt; 13    1 0.16418578 0.24215292 0.4004292 0.39957082 0.2 0.4004292  3.995708e-01</span>
<span class="co">#&gt; 14    1 0.17541275 0.28109245 0.3816518 0.41834821 0.2 0.3816518  4.183482e-01</span>
<span class="co">#&gt; 15    1 0.18459092 0.32068532 0.3686669 0.43133310 0.2 0.3686669  4.313331e-01</span>
<span class="co">#&gt; 16    1 0.19292488 0.36283547 0.3567198 0.44328023 0.2 0.3567198  4.432802e-01</span>
<span class="co">#&gt; 17    1 0.20008762 0.40510782 0.3455049 0.45449510 0.2 0.3455049  4.544951e-01</span>
<span class="co">#&gt; 18    1 0.20731175 0.44856233 0.3347411 0.46525886 0.2 0.3347411  4.652589e-01</span>
<span class="co">#&gt; 19    1 0.21227153 0.49332342 0.3257774 0.47422259 0.2 0.3257774  4.742226e-01</span>
<span class="co">#&gt; 20    1 0.21835780 0.53835136 0.3165637 0.48343634 0.2 0.3165637  4.834363e-01</span>
<span class="co">#&gt; 21    1 0.22339349 0.58676776 0.3056511 0.49434893 0.2 0.3056511  4.943489e-01</span>
<span class="co">#&gt; 22    1 0.22847049 0.63301295 0.2971371 0.50286286 0.2 0.2971371  5.028629e-01</span>
<span class="co">#&gt; 23    1 0.23246623 0.67919098 0.2903911 0.50960890 0.2 0.2903911  5.096089e-01</span>
<span class="co">#&gt; 24    1 0.23747513 0.72658190 0.2819238 0.51807620 0.2 0.2819238  5.180762e-01</span>
<span class="co">#&gt; 25    1 0.24143401 0.77432171 0.2738030 0.52619703 0.2 0.2738030  5.261970e-01</span>
<span class="co">#&gt;    SWT qo (STB/day) qg (SCF/day) qw (STB/day)         fg fw GOR (SCF/STB)</span>
<span class="co">#&gt; 1  0.2      0.00000          0.0            0 0.00000000  0      2909.000</span>
<span class="co">#&gt; 2  0.2     98.63014     286915.1            0 0.00000000  0      2909.000</span>
<span class="co">#&gt; 3  0.2    257.53425     749167.1            0 0.00000000  0      2909.000</span>
<span class="co">#&gt; 4  0.2    147.94521     430372.6            0 0.00000000  0      2909.000</span>
<span class="co">#&gt; 5  0.2    117.80822     333545.1            0 0.08888775  0      2831.255</span>
<span class="co">#&gt; 6  0.2    205.47945     589041.0            0 0.14350870  0      2866.666</span>
<span class="co">#&gt; 7  0.2    767.12329    2150685.1            0 0.27831610  0      2803.572</span>
<span class="co">#&gt; 8  0.2    619.17808    1942466.2            0 0.40342932  0      3137.169</span>
<span class="co">#&gt; 9  0.2    586.30137    2120547.4            0 0.51934696  0      3616.822</span>
<span class="co">#&gt; 10 0.2    561.64384    2443837.2            0 0.62670587  0      4351.222</span>
<span class="co">#&gt; 11 0.2    441.09589    2561641.4            0 0.73539791  0      5807.448</span>
<span class="co">#&gt; 12 0.2    383.56164    2797260.6            0 0.80161398  0      7292.858</span>
<span class="co">#&gt; 13 0.2    323.28767    2942466.6            0 0.85220494  0      9101.697</span>
<span class="co">#&gt; 14 0.2    323.28767    3180823.6            0 0.87494696  0      9838.988</span>
<span class="co">#&gt; 15 0.2    265.75342    3238356.6            0 0.90470566  0     12185.569</span>
<span class="co">#&gt; 16 0.2    235.61644    3416436.1            0 0.92689231  0     14499.990</span>
<span class="co">#&gt; 17 0.2    205.47945    3443834.7            0 0.94224041  0     16759.996</span>
<span class="co">#&gt; 18 0.2    205.47945    3534248.3            0 0.94932040  0     17200.008</span>
<span class="co">#&gt; 19 0.2    147.94521    3679448.4            0 0.96844932  0     24870.346</span>
<span class="co">#&gt; 20 0.2    175.34247    3682194.4            0 0.96692758  0     21000.015</span>
<span class="co">#&gt; 21 0.2    147.94521    3975343.1            0 0.97794933  0     26870.375</span>
<span class="co">#&gt; 22 0.2    147.94521    3797257.2            0 0.97974542  0     25666.646</span>
<span class="co">#&gt; 23 0.2    117.80822    3797264.9            0 0.98624528  0     32232.598</span>
<span class="co">#&gt; 24 0.2    147.94521    3917804.7            0 0.98636892  0     26481.458</span>
<span class="co">#&gt; 25 0.2    117.80822    3945205.3            0 0.99142749  0     33488.370</span>
<span class="co">#&gt;        krg/kro</span>
<span class="co">#&gt; 1   0.00000000</span>
<span class="co">#&gt; 2   0.00000000</span>
<span class="co">#&gt; 3   0.00000000</span>
<span class="co">#&gt; 4   0.00000000</span>
<span class="co">#&gt; 5   0.00000000</span>
<span class="co">#&gt; 6   0.03598525</span>
<span class="co">#&gt; 7   0.11938924</span>
<span class="co">#&gt; 8   0.22697201</span>
<span class="co">#&gt; 9   0.34965742</span>
<span class="co">#&gt; 10  0.52284561</span>
<span class="co">#&gt; 11  0.87300577</span>
<span class="co">#&gt; 12  1.26811100</span>
<span class="co">#&gt; 13  1.81222420</span>
<span class="co">#&gt; 14  1.92655723</span>
<span class="co">#&gt; 15  2.68104037</span>
<span class="co">#&gt; 16  3.42752515</span>
<span class="co">#&gt; 17  4.36286170</span>
<span class="co">#&gt; 18  4.14657412</span>
<span class="co">#&gt; 19 10.39295962</span>
<span class="co">#&gt; 20  5.51774285</span>
<span class="co">#&gt; 21 10.15155441</span>
<span class="co">#&gt; 22  8.51771422</span>
<span class="co">#&gt; 23 18.07776677</span>
<span class="co">#&gt; 24  9.91637411</span>
<span class="co">#&gt; 25 28.23865727</span></pre></body></html></div>
</div>
<div id="part-iii-reservoir-forecast" class="section level4">
<h4 class="hasAnchor">
<a href="#part-iii-reservoir-forecast" class="anchor"></a><code>Part III: Reservoir Forecast</code>
</h4>
<div class="sourceCode" id="cb4"><html><body><pre class="r">
<span class="co"># Step I: generating a set of pseudo relative permeability curves using </span>
<span class="co"># laboratory 'Kr' values</span>

<span class="no">sg_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.152</span>, <span class="fl">0.248</span>, <span class="fl">0.352</span>, <span class="fl">0.448</span>, <span class="fl">0.552</span>, <span class="fl">0.65</span>)

<span class="no">krg_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.09</span>, <span class="fl">0.18</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">1</span>)

<span class="no">kro_lab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0.6</span>, <span class="fl">0.35</span>, <span class="fl">0.13</span>, <span class="fl">0.04</span>, <span class="fl">0.01</span>, <span class="fl">0</span>)

<span class="no">swcrit_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.2</span>

<span class="no">sgcrit_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.05</span>

<span class="no">sorgr_lab</span> <span class="kw">&lt;-</span> <span class="fl">0.15</span>

<span class="no">fun_kr</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">swcrit</span>, <span class="no">sgcrit</span>, <span class="no">sorg</span>, <span class="no">sg</span>, <span class="no">krg</span>, <span class="no">kro</span>) {

  <span class="no">kr_est</span> <span class="kw">&lt;-</span> <span class="kw pkg">Rrelperm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rrelperm/man/kr2p_gl.html">kr2p_gl</a></span>(<span class="kw">SWCON</span> <span class="kw">=</span> <span class="no">swcrit</span>, <span class="kw">SOIRG</span> <span class="kw">=</span> <span class="no">sorg</span>, <span class="kw">SORG</span> <span class="kw">=</span> <span class="no">sorg</span>,
                               <span class="kw">SGCON</span> <span class="kw">=</span> <span class="no">sgcrit</span>, <span class="kw">SGCRIT</span> <span class="kw">=</span> <span class="no">sgcrit</span>, <span class="kw">KRGCL</span> <span class="kw">=</span> <span class="fl">1</span>,
                               <span class="kw">KROGCG</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">NG</span> <span class="kw">=</span> <span class="no">x</span>[<span class="fl">1</span>], <span class="kw">NOG</span> <span class="kw">=</span> <span class="no">x</span>[<span class="fl">2</span>], <span class="kw">NP</span> <span class="kw">=</span> <span class="fl">101</span>)

   <span class="no">krg_est_sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">1</span>], <span class="kw">y</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">3</span>], <span class="kw">xout</span> <span class="kw">=</span> <span class="no">sg</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="fl">2</span>)$<span class="no">y</span>

   <span class="no">kro_est_sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">1</span>], <span class="kw">y</span> <span class="kw">=</span> <span class="no">kr_est</span>[,<span class="fl">4</span>], <span class="kw">xout</span> <span class="kw">=</span> <span class="no">sg</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="fl">2</span>)$<span class="no">y</span>

   <span class="no">error</span> <span class="kw">&lt;-</span> (<span class="no">krg</span> - <span class="no">krg_est_sub</span>) ^ <span class="fl">2</span> + (<span class="no">kro</span> - <span class="no">kro_est_sub</span>) ^ <span class="fl">2</span>

   <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">error</span>)
}

<span class="no">par</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>)

<span class="no">opt_results</span> <span class="kw">&lt;-</span> <span class="kw pkg">minpack.lm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html">nls.lm</a></span>(<span class="kw">par</span> <span class="kw">=</span> <span class="no">par</span>, <span class="kw">fn</span> <span class="kw">=</span> <span class="no">fun_kr</span>, <span class="kw">swcrit</span> <span class="kw">=</span> <span class="no">swcrit_lab</span>,
                                  <span class="kw">sgcrit</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>, <span class="kw">sorg</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>, <span class="kw">sg</span> <span class="kw">=</span> <span class="no">sg_lab</span>,
                                  <span class="kw">krg</span> <span class="kw">=</span> <span class="no">krg_lab</span>, <span class="kw">kro</span> <span class="kw">=</span> <span class="no">kro_lab</span>,
                                  <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">10</span>))

<span class="no">sol</span> <span class="kw">&lt;-</span> <span class="no">opt_results</span>$<span class="no">par</span>

<span class="no">sol</span>
<span class="co">#&gt; [1] 3.157478 2.740570</span>

<span class="no">rel_perm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw pkg">Rrelperm</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rrelperm/man/kr2p_gl.html">kr2p_gl</a></span>(<span class="kw">SWCON</span> <span class="kw">=</span> <span class="no">swcrit_lab</span>, <span class="kw">SOIRG</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>,
                                            <span class="kw">SORG</span> <span class="kw">=</span> <span class="no">sorgr_lab</span>, <span class="kw">SGCON</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>,
                                            <span class="kw">SGCRIT</span> <span class="kw">=</span> <span class="no">sgcrit_lab</span>, <span class="kw">KRGCL</span> <span class="kw">=</span> <span class="fl">1</span>,
                                            <span class="kw">KROGCG</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">NG</span> <span class="kw">=</span> <span class="no">sol</span>[<span class="fl">1</span>], <span class="kw">NOG</span> <span class="kw">=</span> <span class="no">sol</span>[<span class="fl">2</span>],
                                            <span class="kw">NP</span> <span class="kw">=</span> <span class="fl">101</span>))

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rel_perm</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Sg"</span>, <span class="st">"Sl"</span>, <span class="st">"Krg"</span>, <span class="st">"Krog"</span>)

<span class="no">p_forecast</span> <span class="kw">&lt;-</span> <span class="no">p</span>

<span class="no">Gi_forecast</span> <span class="kw">&lt;-</span> <span class="no">Gi</span>

<span class="no">wf_forecast</span> <span class="kw">&lt;-</span> <span class="no">wf</span>

<span class="no">time_lst_forecast</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_time.html">mbal_time</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p_forecast</span>)), <span class="st">"year"</span>)

<span class="no">forecast_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_forecast_param_oil.html">mbal_forecast_param_oil</a></span>(<span class="kw">input_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>, <span class="kw">output_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>,
                                        <span class="kw">N</span> <span class="kw">=</span> <span class="fl">10179044</span>, <span class="kw">m</span> <span class="kw">=</span> <span class="fl">0.0</span>, <span class="kw">phi</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">swi</span> <span class="kw">=</span> <span class="fl">0.2</span>,
                                        <span class="kw">Gi</span> <span class="kw">=</span> <span class="no">Gi_forecast</span>, <span class="kw">pb</span> <span class="kw">=</span> <span class="fl">4698</span>, <span class="kw">p</span> <span class="kw">=</span> <span class="no">p_forecast</span>,
                                        <span class="kw">pvt</span> <span class="kw">=</span> <span class="no">pvt_table</span>, <span class="kw">cf</span> <span class="kw">=</span> <span class="fl">2e-6</span>, <span class="kw">wf</span> <span class="kw">=</span> <span class="no">wf_forecast</span>,
                                        <span class="kw">sorg</span> <span class="kw">=</span> <span class="fl">0.15</span>, <span class="kw">rel_perm</span> <span class="kw">=</span> <span class="no">rel_perm</span>)

<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="no">forecast_lst</span>)
<span class="co">#&gt; List of 14</span>
<span class="co">#&gt;  $ input_unit : chr "Field"</span>
<span class="co">#&gt;  $ output_unit: chr "Field"</span>
<span class="co">#&gt;  $ N          : num 10179044</span>
<span class="co">#&gt;  $ m          : num 0</span>
<span class="co">#&gt;  $ phi        : num 0.1</span>
<span class="co">#&gt;  $ swi        : num 0.2</span>
<span class="co">#&gt;  $ pb         : num 4698</span>
<span class="co">#&gt;  $ p          : num [1:25] 5070 4998 4798 4698 4658 ...</span>
<span class="co">#&gt;  $ cf         : num [1:25] 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 ...</span>
<span class="co">#&gt;  $ pvt        :'data.frame': 26 obs. of  9 variables:</span>
<span class="co">#&gt;   ..$ p  : num [1:26] 5070 4998 4798 4698 4658 ...</span>
<span class="co">#&gt;   ..$ Bo : num [1:26] 2.7 2.71 2.74 2.75 2.71 ...</span>
<span class="co">#&gt;   ..$ Rs : num [1:26] 2909 2909 2909 2909 2834 ...</span>
<span class="co">#&gt;   ..$ Rv : num [1:26] 0.000343 0.000343 0.000343 0.000343 0.000116 0.000111 0.000106 0.000094 0.000084 0.000074 ...</span>
<span class="co">#&gt;   ..$ Bg : num [1:26] 9.27e-07 9.31e-07 9.40e-07 9.45e-07 8.30e-04 ...</span>
<span class="co">#&gt;   ..$ Bw : num [1:26] 1.05 1.05 1.05 1.05 1.05 ...</span>
<span class="co">#&gt;   ..$ muo: num [1:26] 0.0742 0.0735 0.0716 0.0706 0.0718 ...</span>
<span class="co">#&gt;   ..$ mug: num [1:26] 0.0742 0.0735 0.0716 0.0706 0.0375 0.0367 0.035 0.0327 0.0306 0.0288 ...</span>
<span class="co">#&gt;   ..$ muw: num [1:26] 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 ...</span>
<span class="co">#&gt;  $ inj        :'data.frame': 25 obs. of  1 variable:</span>
<span class="co">#&gt;   ..$ Gi: num [1:25] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ wf         : num [1:25] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ sorg       : num 0.15</span>
<span class="co">#&gt;  $ rel_perm   :'data.frame': 101 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ Sg  : num [1:101] 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 ...</span>
<span class="co">#&gt;   ..$ Sl  : num [1:101] 1 0.99 0.98 0.97 0.96 0.95 0.94 0.93 0.92 0.91 ...</span>
<span class="co">#&gt;   ..$ Krg : num [1:101] 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ Krog: num [1:101] 1 1 1 1 1 ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "volumetric_forecast_oil" "forecast_oil"</span>

<span class="no">forecast_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_forecast_oil.html">mbal_forecast_oil</a></span>(<span class="no">forecast_lst</span>, <span class="no">time_lst_forecast</span>)

<span class="no">forecast_results</span>
<span class="co">#&gt;    P (psia)       SOo        SGo SWo       SOT           SGT SWT GOR (SCF/STB)</span>
<span class="co">#&gt; 1      5070 0.8000000 0.00000000 0.2 0.8000000 -5.551115e-17 0.2      2909.000</span>
<span class="co">#&gt; 2      4998 0.8000000 0.00000000 0.2 0.8000000 -5.551115e-17 0.2      2909.000</span>
<span class="co">#&gt; 3      4798 0.8000000 0.00000000 0.2 0.8000000 -5.551115e-17 0.2      2909.000</span>
<span class="co">#&gt; 4      4698 0.8000000 0.00000000 0.2 0.8000000 -5.551115e-17 0.2      2909.000</span>
<span class="co">#&gt; 5      4658 0.7714246 0.02857536 0.2 0.7714246  2.857536e-02 0.2      2834.000</span>
<span class="co">#&gt; 6      4598 0.7298841 0.07011589 0.2 0.7298841  7.011589e-02 0.2      2711.109</span>
<span class="co">#&gt; 7      4398 0.5878680 0.21213196 0.2 0.5878680  2.121320e-01 0.2      2434.726</span>
<span class="co">#&gt; 8      4198 0.5315316 0.26846844 0.2 0.5315316  2.684684e-01 0.2      2756.571</span>
<span class="co">#&gt; 9      3998 0.4897793 0.31022073 0.2 0.4897793  3.102207e-01 0.2      3575.263</span>
<span class="co">#&gt; 10     3798 0.4570624 0.34293756 0.2 0.4570624  3.429376e-01 0.2      4839.089</span>
<span class="co">#&gt; 11     3598 0.4321537 0.36784626 0.2 0.4321537  3.678463e-01 0.2      6409.500</span>
<span class="co">#&gt; 12     3398 0.4109145 0.38908553 0.2 0.4109145  3.890855e-01 0.2      8194.483</span>
<span class="co">#&gt; 13     3198 0.3932607 0.40673934 0.2 0.3932607  4.067393e-01 0.2     10126.350</span>
<span class="co">#&gt; 14     2998 0.3756798 0.42432023 0.2 0.3756798  4.243202e-01 0.2     12395.082</span>
<span class="co">#&gt; 15     2798 0.3634578 0.43654224 0.2 0.3634578  4.365422e-01 0.2     14607.129</span>
<span class="co">#&gt; 16     2598 0.3520820 0.44791803 0.2 0.3520820  4.479180e-01 0.2     17168.929</span>
<span class="co">#&gt; 17     2398 0.3413416 0.45865837 0.2 0.3413416  4.586584e-01 0.2     19506.586</span>
<span class="co">#&gt; 18     2198 0.3313004 0.46869960 0.2 0.3313004  4.686996e-01 0.2     22051.752</span>
<span class="co">#&gt; 19     1998 0.3223430 0.47765703 0.2 0.3223430  4.776570e-01 0.2     24916.102</span>
<span class="co">#&gt; 20     1798 0.3137723 0.48622770 0.2 0.3137723  4.862277e-01 0.2     27390.853</span>
<span class="co">#&gt; 21     1598 0.3031383 0.49686166 0.2 0.3031383  4.968617e-01 0.2     30423.569</span>
<span class="co">#&gt; 22     1398 0.2951001 0.50489993 0.2 0.2951001  5.048999e-01 0.2     32402.069</span>
<span class="co">#&gt; 23     1198 0.2884740 0.51152604 0.2 0.2884740  5.115260e-01 0.2     34169.991</span>
<span class="co">#&gt; 24      998 0.2805608 0.51943924 0.2 0.2805608  5.194392e-01 0.2     35108.083</span>
<span class="co">#&gt; 25      798 0.2725757 0.52742427 0.2 0.2725757  5.274243e-01 0.2     35090.204</span>
<span class="co">#&gt;        RF_oil     RF_gas Liq_volume Igd       Isd Inwd        Ifwd Iawd Itot</span>
<span class="co">#&gt; 1  0.00000000 0.00000000  1.0000000  NA        NA   NA          NA   NA   NA</span>
<span class="co">#&gt; 2  0.00355059 0.00355059  1.0000000   0 0.9343125    0 0.065687540    0    1</span>
<span class="co">#&gt; 3  0.01401115 0.01401115  1.0000000   0 0.9377305    0 0.062269502    0    1</span>
<span class="co">#&gt; 4  0.01934261 0.01934261  1.0000000   0 0.9386224    0 0.061377592    0    1</span>
<span class="co">#&gt; 5  0.02328927 0.02323839  0.9664563   0 0.9436595    0 0.056340540    0    1</span>
<span class="co">#&gt; 6  0.03082627 0.03042188  0.9150753   0 0.9511530    0 0.048847003    0    1</span>
<span class="co">#&gt; 7  0.06103050 0.05713655  0.7411780   0 0.9643702    0 0.035629814    0    1</span>
<span class="co">#&gt; 8  0.08726159 0.08054208  0.6730561   0 0.9680812    0 0.031918753    0    1</span>
<span class="co">#&gt; 9  0.11129643 0.10669963  0.6188753   0 0.9709633    0 0.029036699    0    1</span>
<span class="co">#&gt; 10 0.13213760 0.13684142  0.5710297   0 0.9736312    0 0.026368777    0    1</span>
<span class="co">#&gt; 11 0.14864198 0.16875118  0.5296838   0 0.9757733    0 0.024226656    0    1</span>
<span class="co">#&gt; 12 0.16247242 0.20346749  0.4903751   0 0.9777947    0 0.022205321    0    1</span>
<span class="co">#&gt; 13 0.17425986 0.24058605  0.4539689   0 0.9796844    0 0.020315565    0    1</span>
<span class="co">#&gt; 14 0.18439039 0.27980123  0.4168104   0 0.9814505    0 0.018549478    0    1</span>
<span class="co">#&gt; 15 0.19296739 0.31960837  0.3855909   0 0.9830500    0 0.016949964    0    1</span>
<span class="co">#&gt; 16 0.20071944 0.36194763  0.3545102   0 0.9846416    0 0.015358446    0    1</span>
<span class="co">#&gt; 17 0.20744963 0.40437337  0.3240391   0 0.9860825    0 0.013917481    0    1</span>
<span class="co">#&gt; 18 0.21356046 0.44802339  0.2942159   0 0.9874676    0 0.012532409    0    1</span>
<span class="co">#&gt; 19 0.21911022 0.49282580  0.2653071   0 0.9888086    0 0.011191425    0    1</span>
<span class="co">#&gt; 20 0.22413581 0.53800862  0.2366965   0 0.9900843    0 0.009915679    0    1</span>
<span class="co">#&gt; 21 0.22901333 0.58647726  0.2065704   0 0.9913414    0 0.008658638    0    1</span>
<span class="co">#&gt; 22 0.23330486 0.63281937  0.1790563   0 0.9925068    0 0.007493249    0    1</span>
<span class="co">#&gt; 23 0.23734570 0.67905637  0.1527566   0 0.9936344    0 0.006365619    0    1</span>
<span class="co">#&gt; 24 0.24133076 0.72650864  0.1263693   0 0.9947109    0 0.005289050    0    1</span>
<span class="co">#&gt; 25 0.24528974 0.77427656  0.1007812   0 0.9957441    0 0.004255895    0    1</span>

<span class="no">p1</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">SOo</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">mbal_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">SOo</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Oil Saturation Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p1</span></pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">

<span class="no">p2</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`GOR (SCF/STB)`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">mbal_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`GOR (SCF/STB)`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"GOR Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p2</span></pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-4-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">

<span class="no">p3</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`RF_oil`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">mbal_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`RF_oil`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Oil Recovery Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p3</span></pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-4-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">

<span class="no">liq_vol_CCE</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">P</span> <span class="kw">=</span> <span class="no">p_pvt</span>, <span class="kw">liq_vol</span> <span class="kw">=</span> <span class="no">liq_vol</span>)

<span class="no">p4</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`Liq_volume`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">liq_vol_CCE</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">P</span>, <span class="no">`liq_vol`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Lab"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Lab"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"CCE Liquid Volume Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p4</span></pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-4-4.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">

<span class="no">p5</span> <span class="kw">&lt;-</span> <span class="no">forecast_results</span>  <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span>(<span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Isd"</span>, <span class="st">"Ifwd"</span>), <span class="kw">names_to</span> <span class="kw">=</span> <span class="st">"Drive Mechanism"</span>,
                      <span class="kw">values_to</span> <span class="kw">=</span> <span class="st">"Fraction"</span>, <span class="kw">values_drop_na</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">Fraction</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">`Drive Mechanism`</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Energy Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p5</span></pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-4-5.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="example-2-undersaturated-volatile-oil-reservoir-with-water-influx-walsh1994a" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2-undersaturated-volatile-oil-reservoir-with-water-influx-walsh1994a" class="anchor"></a><code>Example 2: Undersaturated Volatile Oil Reservoir with Water Influx</code> <font size="2"> <span class="citation">(Walsh, Ansah, &amp; Raghavan, 1994)</span> </font>
</h3>
<div id="part-i-history-match-1" class="section level4">
<h4 class="hasAnchor">
<a href="#part-i-history-match-1" class="anchor"></a><code>Part I: History Match</code>
</h4>
<div class="sourceCode" id="cb9"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rmbal</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Rrelperm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pracma</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)

<span class="no">p_pvt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4998</span>,    <span class="fl">4798</span>,   <span class="fl">4698</span>, <span class="fl">4658</span>, <span class="fl">4598</span>,   <span class="fl">4398</span>,   <span class="fl">4198</span>,   <span class="fl">3998</span>,   <span class="fl">3798</span>,   <span class="fl">3598</span>,   <span class="fl">3398</span>,   <span class="fl">3198</span>,
           <span class="fl">2998</span>,    <span class="fl">2798</span>,   <span class="fl">2598</span>, <span class="fl">2398</span>, <span class="fl">2198</span>,   <span class="fl">1998</span>,   <span class="fl">1798</span>,   <span class="fl">1598</span>,   <span class="fl">1398</span>,   <span class="fl">1198</span>,   <span class="fl">998</span>, <span class="fl">798</span>,
           <span class="fl">598</span>) <span class="co"># psia</span>

<span class="no">Bo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.71261</span>,    <span class="fl">2.73953</span>,    <span class="fl">2.75371</span>, <span class="fl">2.70727</span>,   <span class="fl">2.63143</span>,    <span class="fl">2.33771</span>,    <span class="fl">2.20391</span>,    <span class="fl">2.09309</span>,
        <span class="fl">1.99116</span>,    <span class="fl">1.90524</span>,    <span class="fl">1.82832</span>, <span class="fl">1.75726</span>,   <span class="fl">1.68592</span>,    <span class="fl">1.63232</span>,    <span class="fl">1.58028</span>,    <span class="fl">1.53414</span>,
        <span class="fl">1.49008</span>,    <span class="fl">1.44996</span>,    <span class="fl">1.41304</span>, <span class="fl">1.36658</span>,   <span class="fl">1.33283</span>,    <span class="fl">1.30465</span>,    <span class="fl">1.27171</span>,    <span class="fl">1.23937</span>,
        <span class="fl">1.20516</span>) <span class="co"># RB/STB</span>

<span class="no">Rs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2909</span>,   <span class="fl">2909</span>,   <span class="fl">2909</span>, <span class="fl">2834</span>, <span class="fl">2711</span>,   <span class="fl">2247</span>,   <span class="fl">2019</span>,   <span class="fl">1828</span>,   <span class="fl">1651</span>,   <span class="fl">1500</span>,   <span class="fl">1364</span>,   <span class="fl">1237</span>,
        <span class="fl">1111</span>, <span class="fl">1013</span>, <span class="fl">918</span>,    <span class="fl">833</span>, <span class="fl">752</span>,   <span class="fl">677</span>,    <span class="fl">608</span>,    <span class="fl">524</span>,    <span class="fl">461</span>,    <span class="fl">406</span>,    <span class="fl">344</span>,    <span class="fl">283</span>,
        <span class="fl">212</span>) <span class="co">#SCF/STB</span>

<span class="no">Bg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.932</span>,  <span class="fl">0.942</span>,  <span class="fl">0.947</span>, <span class="fl">0.83</span>,    <span class="fl">0.835</span>,  <span class="fl">0.853</span>,  <span class="fl">0.874</span>,  <span class="fl">0.901</span>,  <span class="fl">0.933</span>,  <span class="fl">0.97</span>,
        <span class="fl">1.015</span>,  <span class="fl">1.066</span>,  <span class="fl">1.125</span>, <span class="fl">1.196</span>,   <span class="fl">1.281</span>,  <span class="fl">1.38</span>,   <span class="fl">1.498</span>,  <span class="fl">1.642</span>,  <span class="fl">1.819</span>,  <span class="fl">2.035</span>,
        <span class="fl">2.315</span>,  <span class="fl">2.689</span>,  <span class="fl">3.19</span>, <span class="fl">3.911</span>,    <span class="fl">5.034</span>) / <span class="fl">1000</span> <span class="co"># RB/SCF</span>

<span class="no">Rv</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">343</span>,    <span class="fl">343</span>,    <span class="fl">343</span>, <span class="fl">116</span>,   <span class="fl">111</span>,    <span class="fl">106</span>,    <span class="fl">94</span>, <span class="fl">84</span>, <span class="fl">74</span>, <span class="fl">66</span>, <span class="fl">60</span>, <span class="fl">54</span>, <span class="fl">49</span>, <span class="fl">44</span>, <span class="fl">39</span>,
        <span class="fl">36</span>, <span class="fl">33</span>, <span class="fl">30</span>, <span class="fl">28</span>, <span class="fl">26</span>, <span class="fl">25</span>, <span class="fl">24.1</span>,   <span class="fl">23.9</span>,   <span class="fl">24.4</span>,   <span class="fl">26.4</span>) / <span class="fl">1e6</span> <span class="co"># STB/SCF</span>

<span class="no">cw</span> <span class="kw">&lt;-</span> <span class="fl">3e-6</span>

<span class="no">Bwi</span> <span class="kw">&lt;-</span> <span class="fl">1.05</span>

<span class="no">Bw</span> <span class="kw">&lt;-</span> <span class="no">Bwi</span> * <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">cw</span> * (<span class="no">p_pvt</span>[<span class="fl">1</span>] - <span class="no">p_pvt</span>))

<span class="no">muo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">735</span>,   <span class="fl">716</span>, <span class="fl">706</span>, <span class="fl">718</span>, <span class="fl">739</span>, <span class="fl">847</span>, <span class="fl">906</span>, <span class="fl">968</span>, <span class="fl">1028</span>, <span class="fl">1104</span>, <span class="fl">1177</span>, <span class="fl">1242</span>, <span class="fl">1325</span>,
         <span class="fl">1409</span>, <span class="fl">1501</span>, <span class="fl">1598</span>, <span class="fl">1697</span>, <span class="fl">1817</span>, <span class="fl">1940</span>, <span class="fl">2064</span>, <span class="fl">2223</span>, <span class="fl">2438</span>, <span class="fl">2629</span>, <span class="fl">2882</span>,
         <span class="fl">3193</span>) / <span class="fl">10000</span>

<span class="no">mug</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">735</span>,   <span class="fl">716</span>, <span class="fl">706</span>, <span class="fl">375</span>, <span class="fl">367</span>, <span class="fl">350</span>, <span class="fl">327</span>, <span class="fl">306</span>, <span class="fl">288</span>, <span class="fl">271</span>, <span class="fl">255</span>, <span class="fl">240</span>, <span class="fl">227</span>, <span class="fl">214</span>,
         <span class="fl">203</span>, <span class="fl">193</span>, <span class="fl">184</span>, <span class="fl">175</span>, <span class="fl">168</span>, <span class="fl">161</span>, <span class="fl">155</span>, <span class="fl">150</span>, <span class="fl">146</span>, <span class="fl">142</span>, <span class="fl">138</span>) / <span class="fl">10000</span>

<span class="no">muw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.25</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p_pvt</span>))

<span class="no">pvt_table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="no">p_pvt</span>, <span class="kw">Bo</span> <span class="kw">=</span> <span class="no">Bo</span>, <span class="kw">Rs</span> <span class="kw">=</span> <span class="no">Rs</span>, <span class="kw">Rv</span> <span class="kw">=</span> <span class="no">Rv</span>, <span class="kw">Bg</span> <span class="kw">=</span> <span class="no">Bg</span>,
                               <span class="kw">Bw</span> <span class="kw">=</span> <span class="no">Bw</span>, <span class="kw">muo</span> <span class="kw">=</span> <span class="no">muo</span>, <span class="kw">mug</span> <span class="kw">=</span> <span class="no">mug</span>, <span class="kw">muw</span> <span class="kw">=</span> <span class="no">muw</span>)

<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4998</span>,    <span class="fl">4798</span>,   <span class="fl">4698</span>, <span class="fl">4658</span>, <span class="fl">4598</span>,   <span class="fl">4398</span>,   <span class="fl">4198</span>,   <span class="fl">3998</span>,   <span class="fl">3798</span>,   <span class="fl">3598</span>,   <span class="fl">3398</span>,   <span class="fl">3198</span>,
      <span class="fl">2998</span>, <span class="fl">2798</span>,   <span class="fl">2598</span>, <span class="fl">2398</span>, <span class="fl">2198</span>,   <span class="fl">1998</span>,   <span class="fl">1798</span>,   <span class="fl">1598</span>,   <span class="fl">1398</span>,   <span class="fl">1198</span>,   <span class="fl">998</span>, <span class="fl">798</span>,
      <span class="fl">598</span>) <span class="co"># psia</span>

<span class="no">Np</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,  <span class="fl">1.05</span>,   <span class="fl">1.63</span>,   <span class="fl">2.08</span>,   <span class="fl">2.88</span>,   <span class="fl">5.87</span>,   <span class="fl">8.36</span>,   <span class="fl">10.64</span>,  <span class="fl">12.63</span>,  <span class="fl">14.25</span>,  <span class="fl">15.65</span>,  <span class="fl">16.88</span>,
        <span class="fl">17.98</span>,  <span class="fl">18.9</span>,   <span class="fl">19.71</span>,  <span class="fl">20.41</span>,  <span class="fl">21.03</span>,  <span class="fl">21.59</span>,  <span class="fl">22.09</span>,  <span class="fl">22.57</span>,  <span class="fl">22.98</span>,  <span class="fl">23.34</span>,
        <span class="fl">23.69</span>,  <span class="fl">24.03</span>, <span class="fl">24.38</span>) / <span class="fl">100</span>

<span class="no">Rp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,  <span class="fl">2.909</span>,  <span class="fl">2.909</span>, <span class="fl">2.909</span>,   <span class="fl">2.87</span>,   <span class="fl">2.86</span>,   <span class="fl">2.97</span>,   <span class="fl">3.18</span>,   <span class="fl">3.5</span>,    <span class="fl">3.87</span>,   <span class="fl">4.27</span>,   <span class="fl">4.68</span>,   <span class="fl">5.12</span>,
        <span class="fl">5.56</span>,   <span class="fl">6.02</span>,   <span class="fl">6.47</span>,   <span class="fl">6.91</span>,   <span class="fl">7.36</span>,   <span class="fl">7.8</span>,    <span class="fl">8.26</span>,   <span class="fl">8.68</span>,   <span class="fl">9.08</span>,   <span class="fl">9.48</span>,   <span class="fl">9.86</span>,
        <span class="fl">10.25</span>) * <span class="fl">1000</span>   <span class="co"># SCF/STB</span>

<span class="no">Wp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">We</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.0016</span>, <span class="fl">0.0037</span>, <span class="fl">0.005</span>, <span class="fl">0.0067</span>, <span class="fl">0.0149</span>, <span class="fl">0.0261</span>,   <span class="fl">0.03096</span>,    <span class="fl">0.0559</span>, <span class="fl">0.0742</span>,
        <span class="fl">0.0952</span>, <span class="fl">0.1179</span>, <span class="fl">0.1424</span>, <span class="fl">0.1688</span>, <span class="fl">0.1966</span>, <span class="fl">0.2261</span>, <span class="fl">0.257</span>, <span class="fl">0.2892</span>,  <span class="fl">0.3224</span>,
        <span class="fl">0.357</span>, <span class="fl">0.3923</span>, <span class="fl">0.4285</span>,  <span class="fl">0.4658</span>, <span class="fl">0.5038</span>, <span class="fl">0.5425</span>)   <span class="co"># RB</span>

<span class="no">Gi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">Wi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">wf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>))

<span class="no">mbal_optim_oil_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_optim_param_oil.html">mbal_optim_param_oil</a></span>(<span class="kw">input_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>, <span class="kw">output_unit</span> <span class="kw">=</span> <span class="st">"Field"</span>,
                                           <span class="kw">unknown_param</span> <span class="kw">=</span> <span class="st">"N"</span>, <span class="kw">aquifer_model</span> <span class="kw">=</span> <span class="kw">NULL</span>,
                                           <span class="kw">m</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">phi</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">swi</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">Np</span> <span class="kw">=</span> <span class="no">Np</span>,
                                           <span class="kw">Rp</span> <span class="kw">=</span> <span class="no">Rp</span>, <span class="kw">Wp</span> <span class="kw">=</span> <span class="no">Wp</span>, <span class="kw">Gi</span> <span class="kw">=</span> <span class="no">Gi</span>, <span class="kw">Wi</span> <span class="kw">=</span> <span class="no">Wi</span>,
                                           <span class="kw">We</span> <span class="kw">=</span> <span class="no">We</span>, <span class="kw">pb</span> <span class="kw">=</span> <span class="fl">4698</span>, <span class="kw">p</span> <span class="kw">=</span> <span class="no">p</span>, <span class="kw">pvt</span> <span class="kw">=</span> <span class="no">pvt_table</span>,
                                           <span class="kw">cf</span> <span class="kw">=</span> <span class="fl">2e-6</span>, <span class="kw">wf</span> <span class="kw">=</span> <span class="no">wf</span>, <span class="kw">sorg</span> <span class="kw">=</span> <span class="fl">0.15</span>, <span class="kw">sorw</span> <span class="kw">=</span> <span class="fl">0.15</span>)

<span class="no">time_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_time.html">mbal_time</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>)), <span class="st">"year"</span>)

 <span class="co"># a number of plots will be automatically generated for quality check</span>

 <span class="no">optim_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_optim_oil.html">mbal_optim_oil</a></span>(<span class="no">mbal_optim_oil_lst</span>, <span class="no">time_lst</span>)</pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"><img src="VolatileOil_files/figure-html/unnamed-chunk-5-2.png" width="576" style="display: block; margin: auto;"><img src="VolatileOil_files/figure-html/unnamed-chunk-5-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">
 <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="no">optim_results</span>)
<span class="co">#&gt; List of 18</span>
<span class="co">#&gt;  $ input_unit : chr "Field"</span>
<span class="co">#&gt;  $ output_unit: chr "Field"</span>
<span class="co">#&gt;  $ N          : num 0.995</span>
<span class="co">#&gt;  $ m          : num 0</span>
<span class="co">#&gt;  $ phi        : num 0.1</span>
<span class="co">#&gt;  $ swi        : num 0.2</span>
<span class="co">#&gt;  $ pb         : num 4698</span>
<span class="co">#&gt;  $ p          : num [1:25] 4998 4798 4698 4658 4598 ...</span>
<span class="co">#&gt;  $ cf         : num [1:25] 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 2e-06 ...</span>
<span class="co">#&gt;  $ pvt        :'data.frame': 25 obs. of  9 variables:</span>
<span class="co">#&gt;   ..$ p  : num [1:25] 4998 4798 4698 4658 4598 ...</span>
<span class="co">#&gt;   ..$ Bo : num [1:25] 2.71 2.74 2.75 2.71 2.63 ...</span>
<span class="co">#&gt;   ..$ Rs : num [1:25] 2909 2909 2909 2834 2711 ...</span>
<span class="co">#&gt;   ..$ Rv : num [1:25] 0.000343 0.000343 0.000343 0.000116 0.000111 0.000106 0.000094 0.000084 0.000074 0.000066 ...</span>
<span class="co">#&gt;   ..$ Bg : num [1:25] 0.000932 0.000942 0.000947 0.00083 0.000835 0.000853 0.000874 0.000901 0.000933 0.00097 ...</span>
<span class="co">#&gt;   ..$ Bw : num [1:25] 1.05 1.05 1.05 1.05 1.05 ...</span>
<span class="co">#&gt;   ..$ muo: num [1:25] 0.0735 0.0716 0.0706 0.0718 0.0739 ...</span>
<span class="co">#&gt;   ..$ mug: num [1:25] 0.0735 0.0716 0.0706 0.0375 0.0367 0.035 0.0327 0.0306 0.0288 0.0271 ...</span>
<span class="co">#&gt;   ..$ muw: num [1:25] 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 ...</span>
<span class="co">#&gt;  $ prod       :'data.frame': 25 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ Np: num [1:25] 0 0.0105 0.0163 0.0208 0.0288 ...</span>
<span class="co">#&gt;   ..$ Rp: num [1:25] 2909 2909 2909 2909 2870 ...</span>
<span class="co">#&gt;   ..$ Wp: num [1:25] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ inj        :'data.frame': 25 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ Gi: num [1:25] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ Wi: num [1:25] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ We         : num [1:25] 0 0.0016 0.0037 0.005 0.0067 ...</span>
<span class="co">#&gt;  $ aquifer    :List of 3</span>
<span class="co">#&gt;   ..$ input_unit : chr "Field"</span>
<span class="co">#&gt;   ..$ output_unit: chr "Field"</span>
<span class="co">#&gt;   ..$ We         : num [1:25] 0 0.0016 0.0037 0.005 0.0067 ...</span>
<span class="co">#&gt;   ..- attr(*, "class")= chr [1:2] "We" "aquifer"</span>
<span class="co">#&gt;  $ wf         : num [1:25] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ sorw       : num 0.15</span>
<span class="co">#&gt;  $ sorg       : num 0.15</span>
<span class="co">#&gt;  $ p_est      : num [1:25] 4998 4808 4714 4667 4607 ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "water_drive_oil" "mbal_oil"</span></pre></body></html></div>
</div>
<div id="part-ii-reservoir-performance-1" class="section level4">
<h4 class="hasAnchor">
<a href="#part-ii-reservoir-performance-1" class="anchor"></a><code>Part II: Reservoir Performance</code>
</h4>
<div class="sourceCode" id="cb11"><html><body><pre class="r">
<span class="no">mbal_results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mbal_perform_oil.html">mbal_perform_oil</a></span>(<span class="no">optim_results</span>, <span class="no">time_lst</span>)

<span class="no">mbal_results</span>
<span class="co">#&gt;    P (psia) Eo (bbl/STB) Eg (bbl/SCF) Ew (bbl/STB) Ef (bbl/bbl) Eowf (bbl/STB)</span>
<span class="co">#&gt; 1      4998   0.00000000 0.000000e+00 0.0000000000      0.00000     0.00000000</span>
<span class="co">#&gt; 2      4798   0.02692000 1.000000e-05 0.0006301890      0.00040     0.02868332</span>
<span class="co">#&gt; 3      4698   0.04110000 1.500000e-05 0.0009454254      0.00060     0.04374507</span>
<span class="co">#&gt; 4      4658   0.05230828 1.806798e-05 0.0010715464      0.00068     0.05530606</span>
<span class="co">#&gt; 5      4598   0.07258865 2.504177e-05 0.0012607563      0.00080     0.07611553</span>
<span class="co">#&gt; 6      4398   0.15100542 5.197814e-05 0.0018917020      0.00120     0.15629611</span>
<span class="co">#&gt; 7      4198   0.22379893 7.700963e-05 0.0025230264      0.00160     0.23085367</span>
<span class="co">#&gt; 8      3998   0.30660902 1.054881e-04 0.0031547297      0.00200     0.31542806</span>
<span class="co">#&gt; 9      3798   0.40445984 1.391356e-04 0.0037868122      0.00240     0.41504342</span>
<span class="co">#&gt; 10     3598   0.51288984 1.764201e-04 0.0044192740      0.00280     0.52523820</span>
<span class="co">#&gt; 11     3398   0.63907165 2.198088e-04 0.0050521154      0.00320     0.65318505</span>
<span class="co">#&gt; 12     3198   0.78456538 2.698340e-04 0.0056853366      0.00360     0.80044405</span>
<span class="co">#&gt; 13     2998   0.95543181 3.285780e-04 0.0063189379      0.00400     0.97307600</span>
<span class="co">#&gt; 14     2798   1.15058594 3.956801e-04 0.0069529194      0.00440     1.16999590</span>
<span class="co">#&gt; 15     2598   1.38558005 4.764778e-04 0.0075872814      0.00480     1.40675603</span>
<span class="co">#&gt; 16     2398   1.65677793 5.697224e-04 0.0082220242      0.00520     1.67972017</span>
<span class="co">#&gt; 17     2198   1.98211714 6.815793e-04 0.0088571479      0.00560     2.00682588</span>
<span class="co">#&gt; 18     1998   2.37917004 8.180914e-04 0.0094926529      0.00600     2.40564554</span>
<span class="co">#&gt; 19     1798   2.86582128 9.854080e-04 0.0101285392      0.00640     2.89406377</span>
<span class="co">#&gt; 20     1598   3.48856996 1.199491e-03 0.0107648072      0.00680     3.51857970</span>
<span class="co">#&gt; 21     1398   4.27089483 1.468450e-03 0.0114014570      0.00720     4.30267206</span>
<span class="co">#&gt; 22     1198   5.30963651 1.825570e-03 0.0120384890      0.00760     5.34318147</span>
<span class="co">#&gt; 23      998   6.73067313 2.314096e-03 0.0126759033      0.00800     6.76598608</span>
<span class="co">#&gt; 24      798   8.78849343 3.021526e-03 0.0133137002      0.00840     8.82557462</span>
<span class="co">#&gt; 25      598  12.05937042 4.145921e-03 0.0139518798      0.00880    12.09822009</span>
<span class="co">#&gt;    Egwf (bbl/SCF)    Et (bbl)     F (bbl)      We Igd       Isd       Inwd</span>
<span class="co">#&gt; 1    0.000000e+00  0.00000000  0.00000000 0.00000  NA        NA         NA</span>
<span class="co">#&gt; 2    1.060584e-05  0.03014145  0.02876507 0.00160   0 0.8887048 0.05308305</span>
<span class="co">#&gt; 3    1.590879e-05  0.04722870  0.04488547 0.00370   0 0.8659293 0.07834220</span>
<span class="co">#&gt; 4    1.909796e-05  0.06003251  0.05751030 0.00500   0 0.8670227 0.08328820</span>
<span class="co">#&gt; 5    2.625354e-05  0.08243905  0.07934143 0.00670   0 0.8761578 0.08127217</span>
<span class="co">#&gt; 6    5.379592e-05  0.17042304  0.16580924 0.01490   0 0.8816796 0.08742949</span>
<span class="co">#&gt; 7    7.943351e-05  0.25581183  0.24968092 0.02610   0 0.8705304 0.10202812</span>
<span class="co">#&gt; 8    1.085181e-04  0.34482790  0.34594830 0.03096   0 0.8847674 0.08978392</span>
<span class="co">#&gt; 9    1.427719e-04  0.46889055  0.46049167 0.05590   0 0.8583225 0.11921759</span>
<span class="co">#&gt; 10   1.806627e-04  0.59684029  0.58795146 0.07420   0 0.8550914 0.12432137</span>
<span class="co">#&gt; 11   2.246579e-04  0.74515429  0.73455158 0.09520   0 0.8533947 0.12775878</span>
<span class="co">#&gt; 12   2.752896e-04  0.91438493  0.90141092 0.11790   0 0.8537813 0.12893913</span>
<span class="co">#&gt; 13   3.346402e-04  1.11066301  1.09776105 0.14240   0 0.8559807 0.12821171</span>
<span class="co">#&gt; 14   4.023490e-04  1.33300892  1.31967771 0.16880   0 0.8588802 0.12663081</span>
<span class="co">#&gt; 15   4.837535e-04  1.59639800  1.58320645 0.19660   0 0.8636485 0.12315225</span>
<span class="co">#&gt; 16   5.776049e-04  1.89751201  1.88440213 0.22610   0 0.8688131 0.11915603</span>
<span class="co">#&gt; 17   6.900687e-04  2.25389981  2.23738137 0.25700   0 0.8750670 0.11402459</span>
<span class="co">#&gt; 18   8.271878e-04  2.68294684  2.66727368 0.28920   0 0.8823888 0.10779192</span>
<span class="co">#&gt; 19   9.951116e-04  3.20214928  3.18811205 0.32240   0 0.8905414 0.10068238</span>
<span class="co">#&gt; 20   1.209801e-03  3.85817625  3.84775997 0.35700   0 0.8997295 0.09253076</span>
<span class="co">#&gt; 21   1.479368e-03  4.67369037  4.66599741 0.39230   0 0.9092965 0.08393795</span>
<span class="co">#&gt; 22   1.837095e-03  5.74525326  5.73792603 0.42850   0 0.9196068 0.07458331</span>
<span class="co">#&gt; 23   2.326229e-03  7.19832046  7.19635039 0.46580   0 0.9304090 0.06470954</span>
<span class="co">#&gt; 24   3.034267e-03  9.28572194  9.29091735 0.50380   0 0.9417711 0.05425534</span>
<span class="co">#&gt; 25   4.159269e-03 12.58088039 12.60438406 0.54250   0 0.9538063 0.04312099</span>
<span class="co">#&gt;           Ifwd Iawd Itot     RF_oil     RF_gas       SOo        SGo SWo</span>
<span class="co">#&gt; 1           NA   NA   NA 0.00000000 0.00000000 0.8000000 0.00000000 0.2</span>
<span class="co">#&gt; 2  0.058212102    0    1 0.01105711 0.01105711 0.8000000 0.00000000 0.2</span>
<span class="co">#&gt; 3  0.055728542    0    1 0.01723619 0.01723619 0.8000000 0.00000000 0.2</span>
<span class="co">#&gt; 4  0.049689067    0    1 0.02182014 0.02182014 0.7729406 0.02705944 0.2</span>
<span class="co">#&gt; 5  0.042570081    0    1 0.03007314 0.02966996 0.7314766 0.06852338 0.2</span>
<span class="co">#&gt; 6  0.030890894    0    1 0.06063329 0.05961196 0.5916498 0.20835021 0.2</span>
<span class="co">#&gt; 7  0.027441447    0    1 0.08607855 0.08788357 0.5388232 0.26117683 0.2</span>
<span class="co">#&gt; 8  0.025448686    0    1 0.10658258 0.11651173 0.4981240 0.30187596 0.2</span>
<span class="co">#&gt; 9  0.022459891    0    1 0.12924284 0.15550015 0.4700778 0.32992220 0.2</span>
<span class="co">#&gt; 10 0.020587230    0    1 0.14537340 0.19339809 0.4473086 0.35269143 0.2</span>
<span class="co">#&gt; 11 0.018846553    0    1 0.15954811 0.23419403 0.4280104 0.37198962 0.2</span>
<span class="co">#&gt; 12 0.017279523    0    1 0.17208068 0.27684344 0.4116951 0.38830493 0.2</span>
<span class="co">#&gt; 13 0.015807608    0    1 0.18281743 0.32176873 0.3955385 0.40446153 0.2</span>
<span class="co">#&gt; 14 0.014488995    0    1 0.19185821 0.36670047 0.3850566 0.41494338 0.2</span>
<span class="co">#&gt; 15 0.013199239    0    1 0.19973017 0.41332953 0.3753396 0.42466044 0.2</span>
<span class="co">#&gt; 16 0.012030892    0    1 0.20654152 0.45937560 0.3663877 0.43361227 0.2</span>
<span class="co">#&gt; 17 0.010908440    0    1 0.21290570 0.50573336 0.3581669 0.44183308 0.2</span>
<span class="co">#&gt; 18 0.009819257    0    1 0.21824814 0.55218505 0.3510212 0.44897883 0.2</span>
<span class="co">#&gt; 19 0.008776231    0    1 0.22297549 0.59787172 0.3443325 0.45566751 0.2</span>
<span class="co">#&gt; 20 0.007739746    0    1 0.22743593 0.64579607 0.3349172 0.46508278 0.2</span>
<span class="co">#&gt; 21 0.006765543    0    1 0.23132304 0.69023168 0.3286930 0.47130696 0.2</span>
<span class="co">#&gt; 22 0.005809848    0    1 0.23485970 0.73307875 0.3240428 0.47595719 0.2</span>
<span class="co">#&gt; 23 0.004881457    0    1 0.23814274 0.77607192 0.3177759 0.48222409 0.2</span>
<span class="co">#&gt; 24 0.003973603    0    1 0.24135943 0.81808318 0.3114144 0.48858556 0.2</span>
<span class="co">#&gt; 25 0.003072719    0    1 0.24455499 0.86170114 0.3041022 0.49589778 0.2</span>
<span class="co">#&gt;          SOT           SGT       SWT qo (STB/day) qg (SCF/day) qw (STB/day)</span>
<span class="co">#&gt; 1  0.8000000 -5.551115e-17 0.2000000 0.000000e+00   0.00000000            0</span>
<span class="co">#&gt; 2  0.7995258 -5.551115e-17 0.2004742 2.876712e-05   0.08368356            0</span>
<span class="co">#&gt; 3  0.7989034  5.551115e-17 0.2010966 1.589041e-05   0.04622521            0</span>
<span class="co">#&gt; 4  0.7715203  2.699775e-02 0.2014819 1.232877e-05   0.03586438            0</span>
<span class="co">#&gt; 5  0.7297002  6.831404e-02 0.2019858 2.191781e-05   0.06068164            0</span>
<span class="co">#&gt; 6  0.5886492  2.069347e-01 0.2044161 8.191781e-05   0.23349589            0</span>
<span class="co">#&gt; 7  0.5341958  2.580686e-01 0.2077356 6.821918e-05   0.22030137            0</span>
<span class="co">#&gt; 8  0.4932096  2.976144e-01 0.2091761 6.246575e-05   0.24673973            0</span>
<span class="co">#&gt; 9  0.4619193  3.215128e-01 0.2165679 5.452055e-05   0.28410411            0</span>
<span class="co">#&gt; 10 0.4372496  3.407587e-01 0.2219918 4.438356e-05   0.29979452            0</span>
<span class="co">#&gt; 11 0.4159422  3.558419e-01 0.2282158 3.835616e-05   0.31994521            0</span>
<span class="co">#&gt; 12 0.3976264  3.674298e-01 0.2349438 3.369863e-05   0.33350411            0</span>
<span class="co">#&gt; 13 0.3795954  3.781994e-01 0.2422052 3.013699e-05   0.35778630            0</span>
<span class="co">#&gt; 14 0.3669646  3.830057e-01 0.2500298 2.520548e-05   0.35688767            0</span>
<span class="co">#&gt; 15 0.3551390  3.865917e-01 0.2582693 2.219178e-05   0.37178630            0</span>
<span class="co">#&gt; 16 0.3440790  3.889084e-01 0.2670126 1.917808e-05   0.36708219            0</span>
<span class="co">#&gt; 17 0.3337727  3.900564e-01 0.2761709 1.698630e-05   0.36341370            0</span>
<span class="co">#&gt; 18 0.3245128  3.897727e-01 0.2857145 1.534247e-05   0.37219452            0</span>
<span class="co">#&gt; 19 0.3157643  3.886812e-01 0.2955545 1.369863e-05   0.36711233            0</span>
<span class="co">#&gt; 20 0.3048157  3.893749e-01 0.3058094 1.315068e-05   0.38701918            0</span>
<span class="co">#&gt; 21 0.2967285  3.869997e-01 0.3162718 1.123288e-05   0.35721096            0</span>
<span class="co">#&gt; 22 0.2900373  3.829618e-01 0.3270009 9.863014e-06   0.34139178            0</span>
<span class="co">#&gt; 23 0.2821413  3.798026e-01 0.3380561 9.589041e-06   0.34668493            0</span>
<span class="co">#&gt; 24 0.2743341  3.763472e-01 0.3493187 9.315068e-06   0.33848219            0</span>
<span class="co">#&gt; 25 0.2659824  3.732288e-01 0.3607888 9.589041e-06   0.35504658            0</span>
<span class="co">#&gt;            fg fw GOR (SCF/STB)      krg/kro</span>
<span class="co">#&gt; 1  0.00000000  0      2909.000   0.00000000</span>
<span class="co">#&gt; 2  0.00000000  0      2909.000   0.00000000</span>
<span class="co">#&gt; 3  0.00000000  0      2909.000   0.00000000</span>
<span class="co">#&gt; 4  0.09607112  0      2909.000   0.01812558</span>
<span class="co">#&gt; 5  0.10694814  0      2768.600   0.01310397</span>
<span class="co">#&gt; 6  0.27705964  0      2850.368   0.13036359</span>
<span class="co">#&gt; 7  0.40937646  0      3229.317   0.24874253</span>
<span class="co">#&gt; 8  0.54851501  0      3950.000   0.43213741</span>
<span class="co">#&gt; 9  0.67861515  0      5210.955   0.76063387</span>
<span class="co">#&gt; 10 0.76606042  0      6754.630   1.18495594</span>
<span class="co">#&gt; 11 0.82275924  0      8341.429   1.68006094</span>
<span class="co">#&gt; 12 0.86175290  0      9896.667   2.18030719</span>
<span class="co">#&gt; 13 0.89441397  0     11872.000   2.94116492</span>
<span class="co">#&gt; 14 0.91691228  0     14159.130   3.88049607</span>
<span class="co">#&gt; 15 0.93603372  0     16753.333   5.00845785</span>
<span class="co">#&gt; 16 0.94903463  0     19140.714   6.39676123</span>
<span class="co">#&gt; 17 0.95907154  0     21394.516   7.65387959</span>
<span class="co">#&gt; 18 0.96763229  0     24259.107   9.44826369</span>
<span class="co">#&gt; 19 0.97406048  0     26799.200  11.69654612</span>
<span class="co">#&gt; 20 0.97991984  0     29429.583  14.29789670</span>
<span class="co">#&gt; 21 0.98372858  0     31800.488  18.51536769</span>
<span class="co">#&gt; 22 0.98730006  0     34613.333  26.16014473</span>
<span class="co">#&gt; 23 0.99011847  0     36154.286  36.70396847</span>
<span class="co">#&gt; 24 0.99219882  0     36337.059  49.44417536</span>
<span class="co">#&gt; 25 0.99429016  0     37026.286 295.30148550</span>

<span class="no">reservoir_performance_table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="no">p</span>)

<span class="no">reservoir_performance_table</span>$<span class="no">`RF_oil`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1.05</span>, <span class="fl">1.63</span>, <span class="fl">2.08</span>, <span class="fl">2.88</span>, <span class="fl">5.87</span>, <span class="fl">8.36</span>,
                                          <span class="fl">10.64</span>, <span class="fl">12.63</span>, <span class="fl">14.25</span>,  <span class="fl">15.65</span>, <span class="fl">16.88</span>, <span class="fl">17.98</span>,
                                          <span class="fl">18.9</span>, <span class="fl">19.71</span>, <span class="fl">20.41</span>, <span class="fl">21.03</span>,    <span class="fl">21.59</span>, <span class="fl">22.09</span>,
                                          <span class="fl">22.57</span>, <span class="fl">22.98</span>, <span class="fl">23.34</span>, <span class="fl">23.69</span>, <span class="fl">24.03</span>,
                                          <span class="fl">24.38</span>) / <span class="fl">100</span>

<span class="no">reservoir_performance_table</span>$<span class="no">`Sg`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,    <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">3.4</span>,    <span class="fl">8.6</span>,    <span class="fl">26.1</span>,   <span class="fl">32.8</span>,   <span class="fl">37.7</span>,   <span class="fl">41.7</span>,
                                      <span class="fl">44.7</span>, <span class="fl">47.4</span>,   <span class="fl">49.7</span>,   <span class="fl">52.1</span>,   <span class="fl">53.8</span>,   <span class="fl">55.4</span>,   <span class="fl">57.1</span>,   <span class="fl">58.6</span>,
                                      <span class="fl">60.1</span>, <span class="fl">61.6</span>,   <span class="fl">63.6</span>,   <span class="fl">65.1</span>,   <span class="fl">66.6</span>,   <span class="fl">68.4</span>,   <span class="fl">70.3</span>,
                                      <span class="fl">72.5</span>) * <span class="fl">0.8</span> / <span class="fl">100</span>

<span class="no">reservoir_performance_table</span>$<span class="no">`GOR`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.91</span>,    <span class="fl">2.91</span>,   <span class="fl">2.91</span>,   <span class="fl">2.83</span>,   <span class="fl">2.75</span>,   <span class="fl">2.98</span>,   <span class="fl">3.49</span>,   <span class="fl">4.48</span>,
                                       <span class="fl">5.9</span>, <span class="fl">7.62</span>,   <span class="fl">9.14</span>,   <span class="fl">10.87</span>,  <span class="fl">12.96</span>,  <span class="fl">15.23</span>,  <span class="fl">18.09</span>,
                                       <span class="fl">20.54</span>,   <span class="fl">22.88</span>,  <span class="fl">25.63</span>,  <span class="fl">28.03</span>,  <span class="fl">31.09</span>,  <span class="fl">33.28</span>,
                                       <span class="fl">35.48</span>,   <span class="fl">37.12</span>,  <span class="fl">37.3</span>,   <span class="fl">35.28</span>) * <span class="fl">1000</span> <span class="co"># SCF/STB</span>

<span class="no">p1</span> <span class="kw">&lt;-</span> <span class="no">mbal_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">SGo</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">reservoir_performance_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`p`</span>, <span class="no">Sg</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Gas Saturation Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p1</span></pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">

<span class="no">p2</span> <span class="kw">&lt;-</span> <span class="no">mbal_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`GOR (SCF/STB)`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">reservoir_performance_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`p`</span>, <span class="no">GOR</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"GOR Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p2</span></pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-6-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">

<span class="no">p3</span> <span class="kw">&lt;-</span> <span class="no">mbal_results</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">`RF_oil`</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Forecast"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">reservoir_performance_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`p`</span>, <span class="no">RF_oil</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Field"</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Data"</span>, <span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forecast"</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="st">"Field"</span> <span class="kw">=</span> <span class="st">"black"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Oil Recovery Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p3</span></pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-6-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><html><body><pre class="r">

<span class="no">p4</span> <span class="kw">&lt;-</span> <span class="no">mbal_results</span>  <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span>(<span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Inwd"</span>, <span class="st">"Isd"</span>, <span class="st">"Ifwd"</span>), <span class="kw">names_to</span> <span class="kw">=</span> <span class="st">"Drive Mechanism"</span>,
                      <span class="kw">values_to</span> <span class="kw">=</span> <span class="st">"Fraction"</span>, <span class="kw">values_drop_na</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">`P (psia)`</span>, <span class="no">Fraction</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">`Drive Mechanism`</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Energy Plot"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="no">p4</span></pre></body></html></div>
<p><img src="VolatileOil_files/figure-html/unnamed-chunk-6-4.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a><code>References</code>
</h2>
<div id="refs" class="references">
<div id="ref-Walsh1995">
<p>Walsh, M. P. (1995). A Generalized Approach to Reservoir Material Balance Calculations. <em>Journal of Canadian Petroleum Technology</em>, <em>34</em>(01), 10. <a href="https://doi.org/10.2118/95-01-07">https://doi.org/10.2118/95-01-07</a></p>
</div>
<div id="ref-Walsh1994a">
<p>Walsh, M. P., Ansah, J., &amp; Raghavan, R. (1994). New, generalized material balance as an equation of a straight line: Part 1- Applications to undersaturated, volumetric reservoirs. <em>Proceedings of the Permian Basin Oil &amp; Gas Recovery Conference</em>, 549â€“564. <a href="https://doi.org/10.2118/27684-MS">https://doi.org/10.2118/27684-MS</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://susaenergy.com/">Farshad Tabasinejad</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
